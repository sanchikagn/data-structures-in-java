/*! controltag - v5.65.7 - git 8443f4a - 2016-03-24 13:16:26 */
!function(){var a,b;a=function(b,c){a[b]=c},b=function(){var c;return c={},b=function(d){if(b[d]===c)throw new Error("Circular require: "+d);if(null==a[d])throw new Error("Unknown require: "+d);return d in b?b[d]:(b[d]=c,b[d]=new function(){return a[d](b,this)||this})}}(),a("hogan-3",function(a,b,c){var d={};!function(a){function b(a,b,c){var d;return b&&"object"==typeof b&&(void 0!==b[a]?d=b[a]:c&&b.get&&"function"==typeof b.get&&(d=b.get(a))),d}function c(a,b,c,d,e,f){function g(){}function h(){}g.prototype=a,h.prototype=a.subs;var i,j=new g;j.subs=new h,j.subsText={},j.buf="",d=d||{},j.stackSubs=d,j.subsText=f;for(i in b)d[i]||(d[i]=b[i]);for(i in d)j.subs[i]=d[i];e=e||{},j.stackPartials=e;for(i in c)e[i]||(e[i]=c[i]);for(i in e)j.partials[i]=e[i];return j}function d(a){return String(null===a||void 0===a?"":a)}function e(a){return a=d(a),k.test(a)?a.replace(f,"&amp;").replace(g,"&lt;").replace(h,"&gt;").replace(i,"&#39;").replace(j,"&quot;"):a}a.Template=function(a,b,c,d){a=a||{},this.r=a.code||this.r,this.c=c,this.options=d||{},this.text=b||"",this.partials=a.partials||{},this.subs=a.subs||{},this.buf=""},a.Template.prototype={r:function(a,b,c){return""},v:e,t:d,render:function(a,b,c){return this.ri([a],b||{},c)},ri:function(a,b,c){return this.r(a,b,c)},ep:function(a,b){var d=this.partials[a],e=b[d.name];if(d.instance&&d.base==e)return d.instance;if("string"==typeof e){if(!this.c)throw new Error("No compiler available.");e=this.c.compile(e,this.options)}if(!e)return null;if(this.partials[a].base=e,d.subs){b.stackText||(b.stackText={});for(key in d.subs)b.stackText[key]||(b.stackText[key]=void 0!==this.activeSub&&b.stackText[this.activeSub]?b.stackText[this.activeSub]:this.text);e=c(e,d.subs,d.partials,this.stackSubs,this.stackPartials,b.stackText)}return this.partials[a].instance=e,e},rp:function(a,b,c,d){var e=this.ep(a,c);return e?e.ri(b,c,d):""},rs:function(a,b,c){var d=a[a.length-1];if(!l(d))return void c(a,b,this);for(var e=0;e<d.length;e++)a.push(d[e]),c(a,b,this),a.pop()},s:function(a,b,c,d,e,f,g){var h;return l(a)&&0===a.length?!1:("function"==typeof a&&(a=this.ms(a,b,c,d,e,f,g)),h=!!a,!d&&h&&b&&b.push("object"==typeof a?a:b[b.length-1]),h)},d:function(a,c,d,e){var f,g=a.split("."),h=this.f(g[0],c,d,e),i=this.options.modelGet,j=null;if("."===a&&l(c[c.length-2]))h=c[c.length-1];else for(var k=1;k<g.length;k++)f=b(g[k],h,i),void 0!==f?(j=h,h=f):h="";return e&&!h?!1:(e||"function"!=typeof h||(c.push(j),h=this.mv(h,c,d),c.pop()),h)},f:function(a,c,d,e){for(var f=!1,g=null,h=!1,i=this.options.modelGet,j=c.length-1;j>=0;j--)if(g=c[j],f=b(a,g,i),void 0!==f){h=!0;break}return h?(e||"function"!=typeof f||(f=this.mv(f,c,d)),f):e?!1:""},ls:function(a,b,c,e,f){var g=this.options.delimiters;return this.options.delimiters=f,this.b(this.ct(d(a.call(b,e)),b,c)),this.options.delimiters=g,!1},ct:function(a,b,c){if(this.options.disableLambda)throw new Error("Lambda features disabled.");return this.c.compile(a,this.options).render(b,c)},b:function(a){this.buf+=a},fl:function(){var a=this.buf;return this.buf="",a},ms:function(a,b,c,d,e,f,g){var h,i=b[b.length-1],j=a.call(i);return"function"==typeof j?d?!0:(h=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(j,i,c,h.substring(e,f),g)):j},mv:function(a,b,c){var e=b[b.length-1],f=a.call(e);return"function"==typeof f?this.ct(d(f.call(e)),e,c):f},sub:function(a,b,c,d){var e=this.subs[a];e&&(this.activeSub=a,e(b,c,this,d),this.activeSub=!1)}};var f=/&/g,g=/</g,h=/>/g,i=/\'/g,j=/\"/g,k=/[&<>\"\']/,l=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}}("undefined"!=typeof b?b:d),function(a){function b(a){"}"===a.n.substr(a.n.length-1)&&(a.n=a.n.substring(0,a.n.length-1))}function c(a){return a.trim?a.trim():a.replace(/^\s*|\s*$/g,"")}function d(a,b,c){if(b.charAt(c)!=a.charAt(0))return!1;for(var d=1,e=a.length;e>d;d++)if(b.charAt(c+d)!=a.charAt(d))return!1;return!0}function e(b,c,d,h){var i=[],j=null,k=null,l=null;for(k=d[d.length-1];b.length>0;){if(l=b.shift(),k&&"<"==k.tag&&!(l.tag in v))throw new Error("Illegal content in < super tag.");if(a.tags[l.tag]<=a.tags.$||f(l,h))d.push(l),l.nodes=e(b,l.tag,d,h);else{if("/"==l.tag){if(0===d.length)throw new Error("Closing tag without opener: /"+l.n);if(j=d.pop(),l.n!=j.n&&!g(l.n,j.n,h))throw new Error("Nesting error: "+j.n+" vs. "+l.n);return j.end=l.i,i}"\n"==l.tag&&(l.last=0==b.length||"\n"==b[0].tag)}i.push(l)}if(d.length>0)throw new Error("missing closing tag: "+d.pop().n);return i}function f(a,b){for(var c=0,d=b.length;d>c;c++)if(b[c].o==a.n)return a.tag="#",!0}function g(a,b,c){for(var d=0,e=c.length;e>d;d++)if(c[d].c==a&&c[d].o==b)return!0}function h(a){var b=[];for(var c in a)b.push('"'+j(c)+'": function(c,p,t,i) {'+a[c]+"}");return"{ "+b.join(",")+" }"}function i(a){var b=[];for(var c in a.partials)b.push('"'+j(c)+'":{name:"'+j(a.partials[c].name)+'", '+i(a.partials[c])+"}");return"partials: {"+b.join(",")+"}, subs: "+h(a.subs)}function j(a){return a.replace(s,"\\\\").replace(p,'\\"').replace(q,"\\n").replace(r,"\\r").replace(t,"\\u2028").replace(u,"\\u2029")}function k(a){return~a.indexOf(".")?"d":"f"}function l(a,b){var c="<"+(b.prefix||""),d=c+a.n+w++;return b.partials[d]={name:a.n,partials:{}},b.code+='t.b(t.rp("'+j(d)+'",c,p,"'+(a.indent||"")+'"));',d}function m(a,b){b.code+="t.b(t.t(t."+k(a.n)+'("'+j(a.n)+'",c,p,0)));'}function n(a){return"t.b("+a+");"}var o=/\S/,p=/\"/g,q=/\n/g,r=/\r/g,s=/\\/g,t=/\u2028/,u=/\u2029/;a.tags={"#":1,"^":2,"<":3,$:4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12},a.scan=function(e,f){function g(){s.length>0&&(t.push({tag:"_t",text:new String(s)}),s="")}function h(){for(var b=!0,c=w;c<t.length;c++)if(b=a.tags[t[c].tag]<a.tags._v||"_t"==t[c].tag&&null===t[c].text.match(o),!b)return!1;return b}function i(a,b){if(g(),a&&h())for(var c,d=w;d<t.length;d++)t[d].text&&((c=t[d+1])&&">"==c.tag&&(c.indent=t[d].text.toString()),t.splice(d,1));else b||t.push({tag:"\n"});u=!1,w=t.length}function j(a,b){var d="="+y,e=a.indexOf(d,b),f=c(a.substring(a.indexOf("=",b)+1,e)).split(" ");return x=f[0],y=f[f.length-1],e+d.length-1}var k=e.length,l=0,m=1,n=2,p=l,q=null,r=null,s="",t=[],u=!1,v=0,w=0,x="{{",y="}}";for(f&&(f=f.split(" "),x=f[0],y=f[1]),v=0;k>v;v++)p==l?d(x,e,v)?(--v,g(),p=m):"\n"==e.charAt(v)?i(u):s+=e.charAt(v):p==m?(v+=x.length-1,r=a.tags[e.charAt(v+1)],q=r?e.charAt(v+1):"_v","="==q?(v=j(e,v),p=l):(r&&v++,p=n),u=v):d(y,e,v)?(t.push({tag:q,n:c(s),otag:x,ctag:y,i:"/"==q?u-x.length:v+y.length}),s="",v+=y.length-1,p=l,"{"==q&&("}}"==y?v++:b(t[t.length-1]))):s+=e.charAt(v);return i(u,!0),t};var v={_t:!0,"\n":!0,$:!0,"/":!0};a.stringify=function(b,c,d){return"{code: function (c,p,i) { "+a.wrapMain(b.code)+" },"+i(b)+"}"};var w=0;a.generate=function(b,c,d){w=0;var e={code:"",subs:{},partials:{}};return a.walk(b,e),d.asString?this.stringify(e,c,d):this.makeTemplate(e,c,d)},a.wrapMain=function(a){return'var t=this;t.b(i=i||"");'+a+"return t.fl();"},a.template=a.Template,a.makeTemplate=function(a,b,c){var d=this.makePartials(a);return d.code=new Function("c","p","i",this.wrapMain(a.code)),new this.template(d,b,this,c)},a.makePartials=function(a){var b,c={subs:{},partials:a.partials,name:a.name};for(b in c.partials)c.partials[b]=this.makePartials(c.partials[b]);for(b in a.subs)c.subs[b]=new Function("c","p","t","i",a.subs[b]);return c},a.codegen={"#":function(b,c){c.code+="if(t.s(t."+k(b.n)+'("'+j(b.n)+'",c,p,1),c,p,0,'+b.i+","+b.end+',"'+b.otag+" "+b.ctag+'")){t.rs(c,p,function(c,p,t){',a.walk(b.nodes,c),c.code+="});c.pop();}"},"^":function(b,c){c.code+="if(!t.s(t."+k(b.n)+'("'+j(b.n)+'",c,p,1),c,p,1,0,0,"")){',a.walk(b.nodes,c),c.code+="};"},">":l,"<":function(b,c){var d={partials:{},code:"",subs:{},inPartial:!0};a.walk(b.nodes,d);var e=c.partials[l(b,c)];e.subs=d.subs,e.partials=d.partials},$:function(b,c){var d={subs:{},code:"",partials:c.partials,prefix:b.n};a.walk(b.nodes,d),c.subs[b.n]=d.code,c.inPartial||(c.code+='t.sub("'+j(b.n)+'",c,p,i);')},"\n":function(a,b){b.code+=n('"\\n"'+(a.last?"":" + i"))},_v:function(a,b){b.code+="t.b(t.v(t."+k(a.n)+'("'+j(a.n)+'",c,p,0)));'},_t:function(a,b){b.code+=n('"'+j(a.text)+'"')},"{":m,"&":m},a.walk=function(b,c){for(var d,e=0,f=b.length;f>e;e++)d=a.codegen[b[e].tag],d&&d(b[e],c);return c},a.parse=function(a,b,c){return c=c||{},e(a,"",[],c.sectionTags||[])},a.cache={},a.cacheKey=function(a,b){return[a,!!b.asString,!!b.disableLambda,b.delimiters,!!b.modelGet].join("||")},a.compile=function(b,c){c=c||{};var d=a.cacheKey(b,c),e=this.cache[d];if(e){var f=e.partials;for(var g in f)delete f[g].instance;return e}return e=this.generate(this.parse(this.scan(b,c.delimiters),b,c),b,c),this.cache[d]=e}}("undefined"!=typeof b?b:d),"undefined"!=typeof c&&c.exports&&(c.exports=d)}),a("postscribe",function(a,b,c){!function(){function a(a,g){a=a||"",g=g||{};for(var h in b)b.hasOwnProperty(h)&&(g.autoFix&&(g["fix_"+h]=!0),g.fix=g.fix||g["fix_"+h]);var i=[],j=document.createElement("div"),k=function(a){return"string"==typeof a&&-1!==a.indexOf("&")?(j.innerHTML=a,j.textContent||j.innerText||a):a},l=function(b){a+=b},m=function(b){a=b+a},n={comment:/^<!--/,endTag:/^<\//,atomicTag:/^<\s*(script|style|noscript|iframe|textarea)[\s\/>]/i,startTag:/^</,chars:/^[^<]/},o={comment:function(){var b=a.indexOf("-->");return b>=0?{content:a.substr(4,b),length:b+3}:void 0},endTag:function(){var b=a.match(d);return b?{tagName:b[1],length:b[0].length}:void 0},atomicTag:function(){var b=o.startTag();if(b){var c=a.slice(b.length);if(c.match(new RegExp("</\\s*"+b.tagName+"\\s*>","i"))){var d=c.match(new RegExp("([\\s\\S]*?)</\\s*"+b.tagName+"\\s*>","i"));if(d)return{tagName:b.tagName,attrs:b.attrs,content:d[1],length:d[0].length+b.length}}}},startTag:function(){var b=a.indexOf(">");if(-1===b)return null;var d=a.match(c);if(d){var g={},h={},i=d[2];return d[2].replace(e,function(a,b){if(arguments[2]||arguments[3]||arguments[4]||arguments[5])if(arguments[5])g[arguments[5]]="",h[b]=!0;else{var c=arguments[2]||arguments[3]||arguments[4]||f.test(b)&&b||"";g[b]=k(c)}else g[b]=null;i=i.replace(a,"")}),{tagName:d[1],attrs:g,booleanAttrs:h,rest:i,unary:!!d[3],length:d[0].length}}},chars:function(){var b=a.indexOf("<");return{length:b>=0?b:a.length}}},p=function(){for(var b in n)if(n[b].test(a)){var c=o[b]();return c?(c.type=c.type||b,c.text=a.substr(0,c.length),a=a.slice(c.length),c):null}},q=function(a){for(var b;b=p();)if(a[b.type]&&a[b.type](b)===!1)return},r=function(){var b=a;return a="",b},s=function(){return a};return g.fix&&!function(){var b=/^(AREA|BASE|BASEFONT|BR|COL|FRAME|HR|IMG|INPUT|ISINDEX|LINK|META|PARAM|EMBED)$/i,c=/^(COLGROUP|DD|DT|LI|OPTIONS|P|TD|TFOOT|TH|THEAD|TR)$/i,d=[];d.last=function(){return this[this.length-1]},d.lastTagNameEq=function(a){var b=this.last();return b&&b.tagName&&b.tagName.toUpperCase()===a.toUpperCase()},d.containsTagName=function(a){for(var b,c=0;b=this[c];c++)if(b.tagName===a)return!0;return!1};var e=function(a){return a&&"startTag"===a.type&&(a.unary=b.test(a.tagName)||a.unary,a.html5Unary=!/\/>$/.test(a.text)),a},f=p,h=function(){var b=a,c=e(f());return a=b,c},i=function(){var a=d.pop();m("</"+a.tagName+">")},j={startTag:function(a){var b=a.tagName;"TR"===b.toUpperCase()&&d.lastTagNameEq("TABLE")?(m("<TBODY>"),l()):g.fix_selfClose&&c.test(b)&&d.containsTagName(b)?d.lastTagNameEq(b)?i():(m("</"+a.tagName+">"),l()):a.unary||d.push(a)},endTag:function(a){var b=d.last();b?g.fix_tagSoup&&!d.lastTagNameEq(a.tagName)?i():d.pop():g.fix_tagSoup&&k()}},k=function(){f(),l()},l=function(){var a=h();a&&j[a.type]&&j[a.type](a)};p=function(){return l(),e(f())}}(),{append:l,readToken:p,readTokens:q,clear:r,rest:s,stack:i}}var b=function(){var a,b={},c=this.document.createElement("div");return a="<P><I></P></I>",c.innerHTML=a,b.tagSoup=c.innerHTML!==a,c.innerHTML="<P><i><P></P></i></P>",b.selfClose=2===c.childNodes.length,b}(),c=/^<([\-A-Za-z0-9_]+)((?:\s+[\w\-]+(?:\s*=?\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,d=/^<\/([\-A-Za-z0-9_]+)[^>]*>/,e=/(?:([\-A-Za-z0-9_]+)\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))|(?:([\-A-Za-z0-9_]+)(\s|$)+)/g,f=/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noresize|noshade|nowrap|readonly|selected)$/i;a.supports=b,a.tokenToString=function(a){var b={comment:function(a){return"<!--"+a.content},endTag:function(a){return"</"+a.tagName+">"},atomicTag:function(a){return b.startTag(a)+a.content+b.endTag(a)},startTag:function(a){var b="<"+a.tagName;for(var c in a.attrs){b+=" "+c;var d=a.attrs[c];"undefined"!=typeof a.booleanAttrs&&"undefined"!=typeof a.booleanAttrs[c]||(b+='="'+(d?d.replace(/(^|[^\\])"/g,'$1\\"'):"")+'"')}return a.rest&&(b+=a.rest),b+(a.unary&&!a.html5Unary?"/>":">")},chars:function(a){return a.text}};return b[a.type](a)},a.escapeAttributes=function(a){var b={};for(var c in a){var d=a[c];b[c]=d&&d.replace(/(^|[^\\])"/g,'$1\\"')}return b};for(var g in b)a.browserHasFlaw=a.browserHasFlaw||!b[g]&&g;this.htmlParser=a}(),function(){function a(){}function b(a){return a!==m&&null!==a}function c(a){return"function"==typeof a}function d(a,b,c){var d,e=a&&a.length||0;for(d=0;e>d;d++)b.call(c,a[d],d)}function e(a,b,c){var d;for(d in a)a.hasOwnProperty(d)&&b.call(c,d,a[d])}function f(a,b){return e(b,function(b,c){a[b]=c}),a}function g(a,c){return a=a||{},e(c,function(c,d){b(a[c])||(a[c]=d)}),a}function h(a){try{return o.call(a)}catch(b){var c=[];return d(a,function(a){c.push(a)}),c}}function i(a){return a&&"tagName"in a?!!~a.tagName.toLowerCase().indexOf("script"):!1}function j(a){return a&&"tagName"in a?!!~a.tagName.toLowerCase().indexOf("style"):!1}var k={afterAsync:a,afterDequeue:a,afterStreamStart:a,afterWrite:a,autoFix:!0,beforeEnqueue:a,beforeWriteToken:function(a){return a},beforeWrite:function(a){return a},done:a,error:function(a){throw a},releaseAsync:!1},l=this,m=void 0;if(!l.postscribe){var n=!1,o=Array.prototype.slice,p=function(a){return a[a.length-1]},q=function(){function a(a,c,d){var e=k+c;if(2===arguments.length){var f=a.getAttribute(e);return b(f)?String(f):f}b(d)&&""!==d?a.setAttribute(e,d):a.removeAttribute(e)}function g(b,c){var d=b.ownerDocument;f(this,{root:b,options:c,win:d.defaultView||d.parentWindow,doc:d,parser:htmlParser("",{autoFix:c.autoFix}),actuals:[b],proxyHistory:"",proxyRoot:d.createElement(b.nodeName),scriptStack:[],writeQueue:[]}),a(this.proxyRoot,"proxyof",0)}var k="data-ps-";return g.prototype.write=function(){[].push.apply(this.writeQueue,arguments);for(var a;!this.deferredRemote&&this.writeQueue.length;)a=this.writeQueue.shift(),c(a)?this.callFunction(a):this.writeImpl(a)},g.prototype.callFunction=function(a){var b={type:"function",value:a.name||a.toString()};this.onScriptStart(b),a.call(this.win,this.doc),this.onScriptDone(b)},g.prototype.writeImpl=function(a){this.parser.append(a);for(var b,c,d,e=[];(b=this.parser.readToken())&&!(c=i(b))&&!(d=j(b));)b=this.options.beforeWriteToken(b),b&&e.push(b);this.writeStaticTokens(e),c&&this.handleScriptToken(b),d&&this.handleStyleToken(b)},g.prototype.writeStaticTokens=function(a){var b=this.buildChunk(a);if(b.actual)return b.html=this.proxyHistory+b.actual,this.proxyHistory+=b.proxy,this.proxyRoot.innerHTML=b.html,n&&(b.proxyInnerHTML=this.proxyRoot.innerHTML),this.walkChunk(),n&&(b.actualInnerHTML=this.root.innerHTML),b},g.prototype.buildChunk=function(a){var b=this.actuals.length,c=[],e=[],f=[];return d(a,function(a){var d=htmlParser.tokenToString(a);if(c.push(d),a.attrs){if(!/^noscript$/i.test(a.tagName)){var g=b++;e.push(d.replace(/(\/?>)/," "+k+"id="+g+" $1")),"ps-script"!==a.attrs.id&&"ps-style"!==a.attrs.id&&f.push("atomicTag"===a.type?"":"<"+a.tagName+" "+k+"proxyof="+g+(a.unary?" />":">"))}}else e.push(d),f.push("endTag"===a.type?d:"")}),{tokens:a,raw:c.join(""),actual:e.join(""),proxy:f.join("")}},g.prototype.walkChunk=function(){for(var c,d=[this.proxyRoot];b(c=d.shift());){var e=1===c.nodeType,f=e&&a(c,"proxyof");if(!f){e&&(this.actuals[a(c,"id")]=c,a(c,"id",null));var g=c.parentNode&&a(c.parentNode,"proxyof");g&&this.actuals[g].appendChild(c)}d.unshift.apply(d,h(c.childNodes))}},g.prototype.handleScriptToken=function(a){var b=this.parser.clear();if(b&&this.writeQueue.unshift(b),a.src=a.attrs.src||a.attrs.SRC,a=this.options.beforeWriteToken(a)){a.src&&this.scriptStack.length?this.deferredRemote=a:this.onScriptStart(a);var c=this;this.writeScriptToken(a,function(){c.onScriptDone(a)})}},g.prototype.handleStyleToken=function(a){var b=this.parser.clear();b&&this.writeQueue.unshift(b),a.type=a.attrs.type||a.attrs.TYPE||"text/css",a=this.options.beforeWriteToken(a),a&&this.writeStyleToken(a),b&&this.write()},g.prototype.writeStyleToken=function(a){var b=this.buildStyle(a);this.insertStyle(b),a.content&&(b.styleSheet&&!b.sheet?b.styleSheet.cssText=a.content:b.appendChild(this.doc.createTextNode(a.content)))},g.prototype.buildStyle=function(a){var b=this.doc.createElement(a.tagName);return b.setAttribute("type",a.type),e(a.attrs,function(a,c){b.setAttribute(a,c)}),b},g.prototype.insertStyle=function(a){this.writeImpl('<span id="ps-style"/>');var b=this.doc.getElementById("ps-style");b.parentNode.replaceChild(a,b)},g.prototype.onScriptStart=function(a){a.outerWrites=this.writeQueue,this.writeQueue=[],this.scriptStack.unshift(a)},g.prototype.onScriptDone=function(a){return a!==this.scriptStack[0]?void this.options.error({message:"Bad script nesting or script finished twice"}):(this.scriptStack.shift(),this.write.apply(this,a.outerWrites),void(!this.scriptStack.length&&this.deferredRemote&&(this.onScriptStart(this.deferredRemote),this.deferredRemote=null)))},g.prototype.writeScriptToken=function(a,b){var c=this.buildScript(a),d=this.shouldRelease(c),e=this.options.afterAsync;a.src&&(c.src=a.src,this.scriptLoadHandler(c,d?e:function(){b(),e()}));try{this.insertScript(c),a.src&&!d||b()}catch(f){this.options.error(f),b()}},g.prototype.buildScript=function(a){var b=this.doc.createElement(a.tagName);return e(a.attrs,function(a,c){b.setAttribute(a,c)}),a.content&&(b.text=a.content),b},g.prototype.insertScript=function(a){this.writeImpl('<span id="ps-script"/>');var b=this.doc.getElementById("ps-script");b.parentNode.replaceChild(a,b)},g.prototype.scriptLoadHandler=function(a,b){function c(){a=a.onload=a.onreadystatechange=a.onerror=null}function d(){c(),b()}function e(a){c(),g(a),b()}var g=this.options.error;f(a,{onload:function(){d()},onreadystatechange:function(){/^(loaded|complete)$/.test(a.readyState)&&d()},onerror:function(){e({message:"remote script failed "+a.src})}})},g.prototype.shouldRelease=function(a){var b=/^script$/i.test(a.nodeName);return!b||!!(this.options.releaseAsync&&a.src&&a.hasAttribute("async"))},g}();l.postscribe=function(){function b(){var a,b=j.shift();b&&(a=p(b),a.afterDequeue(),b.stream=d.apply(null,b),a.afterStreamStart())}function d(c,d,g){function j(a){a=g.beforeWrite(a),m.write(a),g.afterWrite(a)}m=new q(c,g),m.id=i++,m.name=g.name||m.id,e.streams[m.name]=m;var k=c.ownerDocument,l={close:k.close,open:k.open,write:k.write,writeln:k.writeln};f(k,{close:a,open:a,write:function(){return j(h(arguments).join(""))},writeln:function(){return j(h(arguments).join("")+"\n")}});var n=m.win.onerror||a;return m.win.onerror=function(a,b,c){g.error({msg:a+" - "+b+":"+c}),n.apply(m.win,arguments)},m.write(d,function(){f(k,l),m.win.onerror=n,g.done(),m=null,b()}),m}function e(d,e,f){c(f)&&(f={done:f}),f=g(f,k),d=/^#/.test(d)?l.document.getElementById(d.substr(1)):d.jquery?d[0]:d;var h=[d,e,f];return d.postscribe={cancel:function(){h.stream?h.stream.abort():h[1]=a}},f.beforeEnqueue(h),j.push(h),m||b(),d.postscribe}var i=0,j=[],m=null;return f(e,{streams:{},queue:j,WriteStream:q})}()}}()}),a("underscore",function(){var a,b=function(a){return a instanceof b?a:this instanceof b?void(this._wrapped=a):new b(a)},c={},d=Array.prototype,e=Object.prototype,f=d.slice,g=e.toString,h=e.hasOwnProperty,i=d.map,j=d.filter,k=d.every,l=d.some,m=d.indexOf,n=Array.isArray,o=b.each=b.forEach=function(b,d,e){if(null!=b)if(a&&b.forEach===a)b.forEach(d,e);else if(b.length===+b.length){for(var f=0,g=b.length;g>f;f++)if(f in b&&d.call(e,b[f],f,b)===c)return}else for(var i in b)if(h.call(b,i)&&d.call(e,i,b[i],b)===c)return};b.map=function(a,b,c){var d=[];return null==a?d:i&&a.map===i?a.map(b,c):(o(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),d)},b.find=function(a,b,c){var d;return p(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},b.every=b.all=function(a,b,d){var e=!0;return null==a?e:k&&a.every===k?a.every(b,d):(o(a,function(a,f,g){return(e=e&&b.call(d,a,f,g))?void 0:c}),e)};var p=b.some=b.any=function(a,d,e){d=d||b.identity;var f=!1;return null==a?f:l&&a.some===l?a.some(d,e):(o(a,function(a,b,g){return f||(f=d.call(e,a,b,g))?c:void 0}),!!f)};return b.include=b.contains=function(a,b){var c=!1;return null==a?c:m&&a.indexOf===m?-1!=a.indexOf(b):c=p(a,function(a){return a===b})},b.filter=function(a,b,c){var d=[];return null==a?d:j&&a.filter===j?a.filter(b,c):(o(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},b.reduce=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError("Reduce of empty array with no initial value");return c},b.indexOf=function(a,b){if(null==a)return-1;var c,d;if(m&&a.indexOf===m)return a.indexOf(b);for(c=0,d=a.length;d>c;c++)if(c in a&&a[c]===b)return c;return-1},b.uniq=b.unique=function(a,c,d){var e=d?b.map(a,d):a,f=[];return a.length<3&&(c=!0),b.reduce(e,function(d,e,g){return(c?b.last(d)===e&&d.length:b.include(d,e))||(d.push(e),f.push(a[g])),d},[]),f},b.difference=function(a){var c=b.flatten(f.call(arguments,1),!0);return b.filter(a,function(a){return!b.include(c,a)})},b.flatten=function(a,c){return b.reduce(a,function(a,d){return b.isArray(d)?a.concat(c?d:b.flatten(d)):(a[a.length]=d,a)},[])},b.union=function(){return b.uniq(b.flatten(arguments,!0,!0))},b.intersection=b.intersect=function(a){var c=f.call(arguments,1);return b.filter(b.uniq(a),function(a){return b.every(c,function(c){return b.indexOf(c,a)>=0})})},b.groupBy=function(a,c){var d={},e=b.isFunction(c)?c:function(a){return a[c]};return o(a,function(a,b){var c=e(a,b);(d[c]||(d[c]=[])).push(a)}),d},b.compact=function(a){return b.filter(a,function(a){return!!a})},b.pluck=function(a,c){return b.map(a,function(a){return a[c]})},b.identity=function(a){return a},b.values=function(a){return b.map(a,b.identity)},b.times=function(a,b,c){for(var d=0;a>d;d++)b.call(c,d)},b.clone=function(a){return b.isObject(a)?b.isArray(a)?a.slice():b.extend({},a):a},b.extend=function(a){return o(f.call(arguments,1),function(b){for(var c in b)void 0!==b[c]&&(a[c]=b[c])}),a},b.defaults=function(a){return o(f.call(arguments,1),function(b){for(var c in b)null==a[c]&&(a[c]=b[c])}),a},b.first=b.head=function(a,b,c){return null==b||c?a[0]:f.call(a,0,b)},b.initial=function(a,b,c){return f.call(a,0,a.length-(null==b||c?1:b))},b.last=function(a,b,c){return null==b||c?a[a.length-1]:f.call(a,Math.max(a.length-b,0))},b.rest=b.tail=function(a,b,c){return f.call(a,null==b||c?1:b)},b.has=function(a,b){return null!=a&&h.call(a,b)},b.keys=function(a){if(!b.isObject(a))return[];var c=[];for(var d in a)b.has(a,d)&&c.push(d);return c},b.size=function(a){return null==a?0:a.length===+a.length?a.length:b.keys(a).length},b.toArray=function(a){return a?a.toArray?a.toArray():b.isArray(a)?f.call(a):b.isArguments(a)?f.call(a):b.values(a):[]},b.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},b.template=function(a,c){var d=b.templateSettings,e="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(d.escape,function(a,b){return"',_.escape("+b.replace(/\\'/g,"'")+"),'"}).replace(d.interpolate,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(d.evaluate||null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",f=new Function("obj","_",e);return c?f(c,b):function(a){return f.call(this,a,b)}},b.isEmpty=function(a){if(b.isArray(a)||b.isString(a))return 0===a.length;for(var c in a)if(h.call(a,c))return!1;return!0},b.isElement=function(a){return!(!a||1!==a.nodeType)},b.isArray=n||function(a){return"[object Array]"==g.call(a)},b.isObject=function(a){return a===Object(a)},"[object Arguments]"==g.call(arguments)?b.isArguments=function(a){return"[object Arguments]"==g.call(a)}:b.isArguments=function(a){return!(!a||!h.call(a,"callee"))},b.isFunction=function(a){return"[object Function]"==g.call(a)},b.isString=function(a){return"[object String]"==g.call(a)},b.isNumber=function(a){return"[object Number]"==g.call(a)},b.isNaN=function(a){return a!==a},b.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==g.call(a)},b.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f},b.now=function(){return(new Date).getTime()},b.throttle=function(a,c,d){var e,f,g,h=null,i=0;d||(d={});var j=function(){i=d.leading===!1?0:b.now(),h=null,g=a.apply(e,f),e=f=null};return function(){var k=b.now();i||d.leading!==!1||(i=k);var l=c-(k-i);return e=this,f=arguments,0>=l?(clearTimeout(h),h=null,i=k,g=a.apply(e,f),e=f=null):h||d.trailing===!1||(h=setTimeout(j,l)),g}},b.partial=function(a){var c=f.call(arguments,1);return function(){for(var d=0,e=c.slice(),f=0,g=e.length;g>f;f++)e[f]===b&&(e[f]=arguments[d++]);for(;d<arguments.length;)e.push(arguments[d++]);return a.apply(this,e)}},b.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},b}),a("adm-events",function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;h=a("util"),p=a("routes"),q=a("store"),c=b.COOKIE_SERVICE_TTL=20*h.MINUTES,d="$event_",e=b.EVENT_TTL=2*h.DAYS,f=8,g=100,l=b.prefix="e_",j=b.knownEventIds=[],i=b.addEventId=function(a){h.contains(j,a)||j.push(a)},k=b.parse=function(a){var b;return b=a.split("&"),{id:b.shift(),attrs:h.parseKeyValues(b.join("&"))}},b.parseConfig=function(a){var b,c,e,j,k,l,m,n;for(j=g,n=function(a){var b,c,e,g,k,l;switch(!1){case!(null==a||0===j--):break;case!h.isString(a):if(e=a.indexOf(d),-1!==e)return i(a.substr(e+d.length,f));break;default:for(k=a.slice(1),l=[],c=0,g=k.length;g>c;c++)b=k[c],l.push(n(b));return l}},l=[],b=0,e=a.length;e>b;b++)k=a[b],c=k.id,m=k.test,l.push(n(m));return l},s=b.stringify=function(a){return a.id+"&"+h.paramString(a.attrs)},r=b.storeEvent=function(a,b){b=b||0,q.set(l+s(a),1,e-b)},n=b.processEvent=function(a){var b,c,d,e,f,g;b="event_"+a.id,h.set(b,!0),e=a.attrs;for(d in e)f=e[d],c=b+"_attr_"+d,g=h.get(c)||h.set(c,[]),h.contains(g,f)||g.push(f)},o=b.readFromStore=function(){var a,b;b=q.namespace(l);for(a in b)n(k(a))},m=b.process3rdParty=function(a){var b,c,d,e,f;d=/^e_(.*)/;for(f in a)e=f.match(d),e&&(c=k(e[1].replace(/\^/g,"&").replace(/\|/g,"=")),h.contains(j,c.id)&&(b=(new Date-new Date(parseInt(a[f],10)))/1e3,r(c,b),n(c)))},b.check3rdParty=function(){return j.length&&!q.get("event3p")?a("http").jsonp({url:h.get("url_cookies")||"//beacon.krxd.net/cookie2json",callback:"kxjsonp_3pevents",done:function(a){return q.set("event3p","1",c),m(a)}}):void 0},o(),p.simple("admEvent",function(b,c){var d;d={id:b,attrs:c},r(d),n(d),a("http").pixel({url:h.get("url_event"),data:h.extend({event_id:b,pub_id:h.get("pubid")},c)})})});var c=[].slice;a("cache",function(a){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q;return p=a("routes").simple,o=a("sha1"),q=a("store"),m=a("util"),b=m.DAY,f=m.defaults,h=m.extend,k=m.identity,d="cache_",i=function(){q.clear(function(a,b){return 0===b.indexOf(d)})},g=function(){var a,b;return b=1<=arguments.length?c.call(arguments,0):[],a=o(""+JSON.stringify(b)),""+d+a},j=function(a,b){var c;return c=q.get(a,b),""!==c?c:void 0},l=function(a,c,d){null==d&&(d=b),null!=a&&null!=c&&q.set(a,c,d)},n=function(a){null!=a&&q.remove(a)},e=function(a,d){var e,h,i,m,n;return null==d&&(d={}),i=f(d,{id:a,parse:k,serialize:k,ttl:b}),e=i.id,h=i.parse,m=i.serialize,n=i.ttl,function(){var b,d,f;return b=1<=arguments.length?c.call(arguments,0):[],d=g(String(e),b),f=j(d),null!=f?h(f):(f=a.apply(null,b),l(d,m(f),n),f)}},p("cache",e),h(e,{PREFIX:d,encode:g,encodeKey:g,flush:i,get:j,put:l,remove:n})}),a("client-type",function(){return{PUBLISHER:0,MARKETER:1}});var d=function(a,b){return function(){return a.apply(b,arguments)}},e=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},f={}.hasOwnProperty,c=[].slice;a("config",function(a){var b,f,g,h,i,j;return f=window,h=a("util"),j=a("store"),g=a("stateful").Stateful,b=function(a){function b(){this._pointerPair=d(this._pointerPair,this),this._makeWatchers=d(this._makeWatchers,this),this.toString=d(this.toString,this),this.toJSON=d(this.toJSON,this),this.destroy=d(this.destroy,this),this.persist=d(this.persist,this),this.has=d(this.has,this),this.remove=d(this.remove,this),this.set=d(this.set,this),this.get=d(this.get,this),b.__super__.constructor.apply(this,arguments),this._handles=[],this._persisted=[],this._defaults={confid:"no-confid"}}return e(b,a),b.prototype.get=function(a,b){var c,d;if(c=this._pointerPair(a),d=h.isString(c[1])?h.deref(c[0],c[1]):c[0],h.isString(d)){if(/^\d{1,12}$/.test(d))return Number(d);if(/^(true|false)$/.test(d))return"true"===d}return null!=d?d:b},b.prototype.set=function(a,b){var c,d;return d=this._pointerPair(a),h.isString(d[1])?(c=h.deref(d[0],d[1]),d[0][d[1]]=b,this._fire("set",a,c,b)):g.prototype.set.apply(this,arguments),this},b.prototype.remove=function(a){var b,c;return c=this._pointerPair(a),h.isString(c[1])?(b=h.deref(c[0],c[1]),delete c[0][c[1]],this._fire("remove",a,b,void 0)):g.prototype.remove.apply(this,arguments),this},b.prototype.has=function(a){return b.__super__.has.call(this,a)||null!=this.get(a)},b.prototype.persist=function(){var a,b,d,e,f,g;return b=1<=arguments.length?c.call(arguments,0):[],b=h.difference(b,this._persisted),d=function(a){return function(b){a.has(b,!0)&&j.set(b,a.get(b))}}(this),b=function(){var c,f,g;for(g=[],c=0,f=b.length;f>c;c++)a=b[c],e=h.partial(d,a),e(),g.push(this._makeWatchers(a,e));return g}.call(this),(f=this._handles).push.apply(f,b),(g=this._persisted).push.apply(g,b),this},b.prototype.destroy=function(){var a,b,c,d;for(d=this._handles,b=0,c=d.length;c>b;b++)(a=d[b])();return this},b.prototype.toJSON=function(){return h.extend({},this._defaults,this._raw)},b.prototype.toString=function(){return"Config"+f.JSON.stringify(this._raw)},b.prototype._has=function(){return g.prototype.has.apply(this,arguments)},b.prototype._makeWatchers=function(a,b){return h.compose(this.watch("set:"+a,b),this.watch("remove:"+a,function(){j.remove(a)}))},b.prototype._pointerPair=function(a){var b,c,d,e,f,i;return b=!1,f=a,e=void 0,a.indexOf(".")>0&&!this._has(a)&&(e=a.split("."),f=e[0],b=!0),i=g.prototype.get.call(this,f),b&&(d=e.slice(1,e.length-1).join("."),d&&(i=h.deref(i,d)),c=e.pop()),[i,c]},b}(g),i=void 0,h.extend(function(a){return!a&&i||(i=new b(a)),i},{Config:b})}),a("context-terms",function(a,b){var c,d,e,f,g,h,i,j;c=window,d=a("util"),f=c.document,g=["a","form","script","noscript","style","select","textarea","button","nav","header","footer"],e=new RegExp("<("+g.join("|")+")\\b","i"),h=new RegExp("^("+g.join("|")+")$","i"),b.process=function(a){var b,c,g,i,j,k,l,m;for(j=[f.body],m="";i=j.shift();)3===i.nodeType?m+=i.nodeValue:1===i.nodeType&&(h.test(i.nodeName)||(e.test(i.innerHTML)?j.unshift.apply(j,d.toArray(i.childNodes)):m+=i.innerText||i.textContent));for(m=m.replace(/\s\s+/g," "),b=0,c=a.length;c>b;b++)l=a[b],l.matches=0,k=new RegExp("\\b"+d.escapeRegexp(l.value)+"\\b","ig"),m.replace(k,function(){l.matches++});return g=function(){var b,c,e;for(e=[],b=0,c=a.length;c>b;b++)l=a[b],
d.set("context_term_"+l.id,l.matches)&&e.push(l);return e}(),d.set("context_terms_processed",!0),d.set("page_attr_kx_context_terms",g),d.set("context_terms",function(){var a,b,c;for(c=[],a=0,b=g.length;b>a;a++)l=g[a],c.push(l.id);return c}()),{text:m,terms:g}},i=a("pixel"),j=b.pixelFormatter=function(a){var b;return function(){var c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(""+b.id+i.tuppleSeparator+b.matches);return e}().join(",")},i.addFormatter("_kpa_kx_context_terms",j)}),a("crypto-util",function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n;return l=32,d=8,f=l/d,e=f*d,c=2,h=16,k="0",i=255,j=4294967295,g=15,n=function(a,b,c){return(a|b<<l-d-c%f*d)>>>0},m=function(a){var b,c,d;for(c=[],b=2*f,d=0;d<a.length;)c.push(a.substr(d,b)),d+=b;return c},b={BITS_PER_BYTE:d,BITS_PER_WORD:e,BYTES_PER_WORD:f,MAX_BYTE:i,MAX_WORD:j,WORD_SIZE:l,pad:function(a,b,c){var d,e,f,g;for(c=c||l,b=b||k,d=[],f=a.length,g=c-f,e=0;g>e;)d.push(b),++e;return d.join("")+a},fromWordToBytesArray:function(a){var b,c,e,g;for(g=[],b=c=0,e=f;e>=0?e>c:c>e;b=e>=0?++c:--c)g.push(a>>>l-d-b%f*d&i);return g},fromBytesArrayToWord:function(a){var b,c,d,e,f;for(f=0,c=d=0,e=a.length;e>d;c=++d)b=a[c],f=n(f,b,c);return f},toWord:function(a){return b.pad(Number(a).toString(c))},fromWord:function(a){return parseInt(a,c)},toHex:function(a){return Number(a).toString(h)},fromHex:function(a){return parseInt(a,h)},rotl:function(a,b,c){return a<<b|a>>>(c||l)-b},rotr:function(a,b,c){return a>>>b|a<<(c||l)-b},fromWordsToLatin1:function(a){var c,d,e,f,g,h,i,j;for(h="",d=0,f=a.length;f>d;d++)for(j=a[d],i=b.fromWordToBytesArray(j),e=0,g=i.length;g>e;e++)c=i[e],h+=String.fromCharCode(c);return h},fromLatin1ToWords:function(a){var b,c,e;for(e=[],b=0,c=a.length;c>b;)e[b>>>2]|=(a.charCodeAt(b)&i)<<l-d-b%f*d,b++;return e},fromWordsToUtf8:function(a){try{return decodeURIComponent(escape(b.fromWordsToLatin1(a)))}catch(c){throw new Error("Malformed UTF-8 data")}},fromUtf8ToWords:function(a){return b.fromLatin1ToWords(unescape(encodeURIComponent(a)))},fromWordsToHex:function(a){var b,c,e,j;for(j=f*a.length,c=[],e=0;j>e;)b=a[e>>>2]>>>l-d-e%f*d&i,c.push((b>>>f).toString(h)),c.push((b&g).toString(h)),e++;return c.join("")},fromHexToWords:function(a){var c,d,e,f;for(e=m(a),f=[],c=0,d=e.length;d>c;c++)a=e[c],f.push(b.fromHex(a));return f},calculateSigBytesForWords:function(a){var c,d,e,f,g,h,i,j;for(i=0,d=0,f=a.length;f>d;d++)for(j=a[d],h=b.fromWordToBytesArray(j),e=0,g=h.length;g>e;e++)c=h[e],c&&(i+=1);return i}}});var d=function(a,b){return function(){return a.apply(b,arguments)}},c=[].slice,f={}.hasOwnProperty;a("dag",function(a){var b,e;return e=a("underscore"),b=function(){function a(){var a;a=1<=arguments.length?c.call(arguments,0):[],this.toArray=d(this.toArray,this),this.size=d(this.size,this),this.add=d(this.add,this),this._roots=[],this._edges=[],this._dependencies={},this.add.apply(this,a)}return a.prototype.add=function(){var a,b,d,e,f,g,h,i,j,k,l,m,n,o,p;for(g=1<=arguments.length?c.call(arguments,0):[],(m=this._edges).push.apply(m,g),null==this._dependencies&&(this._dependencies={}),h=0,j=g.length;j>h;h++)n=g[h],e=n[0],f=n[1],null==(d=this._dependencies)[f]&&(d[f]={}),this._dependencies[f][e]=!0;for(b={},this._roots=[],o=this._edges,i=0,k=o.length;k>i;i++)p=o[i],l=p[0],a=p[1],""+l in this._dependencies||""+l in b||(b[l]=l,this._roots.push(l));return this},a.prototype.size=function(){return this._edges.length},a.prototype.toArray=function(){var a,b,c,d,e,g,h,i,j,k,l,m,n;for(m={},d=this._edges.slice(),n=this._roots.slice(),j=[];null!=(i=n.pop());)for(j.push(i),e=0,h=d.length;h>e;e++)if(k=d[e],b=k[0],c=k[1],b===i){a=!0,null==m[c]&&(m[c]={}),m[c][b]=!0,l=this._dependencies[c];for(g in l)f.call(l,g)&&null==m[c][g]&&(a=!1);a&&n.push(c)}return j},a}(),e.extend(function(){var a,d;return a=1<=arguments.length?c.call(arguments,0):[],(d=new b).add.apply(d,a)},{DirectedAcyclicGraph:b})}),a("data-rewrite",function(a,b){var c,d,e,f,g,h,i;c=a("util"),d=a("config"),f=a("expression"),e=c.rewriter({country:"user_attr_kx_geo_country",sub_section:"subsection",segment:"user_segments"}),h=c.rewriter({"=":"is","!=":"isnt",before:"<",after:">"}),i=function(a){return a=String(a),a.match(/,/)?"["+a.split(", ").join(",")+"]":a},g=b.expression=function(a){var b,d,g,j,k,l,m;if(d=h(a.operator),k=e(a.name),b=a.delimiter,m=c.isArray(a.value)?"["+a.value.join(",")+"]":i(a.value),j=function(a,b,c){var d,e,f,g;for(f=[],d=0,e=a.length;e>d;d++)g=a[d],f.push([b,"$"+c,g]);return f},g=c.isArray(f.get(k,b)),l=f.parse(m),c.isArray(l)){if("is"===d&&(d=g?"intersects":"memberOf"),"isnt"===d&&(d=g?"notIntersects":"notMemberOf"),"url"===k&&!g){if("contains"===d)return["or"].concat(j(l,d,k));if("notContains"===d)return["and"].concat(j(l,d,k))}}else g&&("is"===d&&(d="contains"),"isnt"===d&&(d="notContains"));return b=b?":"+b:"",[d,"$"+k+b,m]},b.tag=function(a){var b;return c.get("schema_version",2)>=3||d().get("params.tag_source",!1)||(a=c.extend({},a,{criteria:["and"].concat(function(){var c,d,e,f;if(a.criteria){for(e=a.criteria,f=[],c=0,d=e.length;d>c;c++)b=e[c],f.push(g(b));return f}return[]}())})),null==a.criteria&&(a.criteria=[]),a.freq_cap&&a.criteria.push(["<","$tag_deliveries_today",a.freq_cap]),a.user_percent&&a.criteria.push(["<",["random"],a.user_percent/100]),delete a.rules,/^\s*\/\/@eval\b/.test(a.content)&&(a.method="eval"),null==a.name&&(a.name="Anonymous"),null==a.timing&&(a.timing="onload"),a.random=100*Math.random(),a},f.setDelimiter("user_segments",","),b.contextTermExpression=function(a){var b,c,d;return b=a.occurrences,d=a.values,f=function(){switch(h(a.operator)){case"is":return["or"].concat(function(){var a,e,f,g;for(f=d.split(","),g=[],a=0,e=f.length;e>a;a++)c=f[a],g.push([">=","$context_term_"+c,(null!=b?b.min:void 0)||1]);return g}());default:return["and"].concat(function(){var a,b,e,f;for(e=d.split(","),f=[],a=0,b=e.length;b>a;a++)c=e[a],f.push(["is","$context_term_"+c,0]);return f}())}}(),["and","$context_terms_processed",f]}});var f={}.hasOwnProperty;a("data",function(a,b){var c,d,e,g,h,i,j,k,l,m,n;c=window,d=a("util"),m=b.root={},h=b.defs={},i=function(a){return a.match(/_/)?a:"_"+a},d.get=b.get=function(a,b){var c;return null!=(c=m[i(a)])?c:b},d.set=b.set=function(a,b){var c,e,g;return d.isString(a)?(e=n(a,b),d.fire("data:change",{key:a,value:e}),e):function(){var b;b=[];for(c in a)f.call(a,c)&&(g=a[c],b.push(d.set(c,g)));return b}()},n=b.setSilently=function(a,b){return m[i(a)]=b},d.removeData=b.remove=function(a){delete m[a]},d.append=b.append=function(a,b){var c,e,g;return d.isString(a)?(a=i(a),e=null!=d.get(a)?d.get(a):[],d.isArray(e)||(e=[e]),e.push(b),d.set(a,d.uniq(e))):function(){var b;b=[];for(c in a)f.call(a,c)&&(g=a[c],b.push(d.append(c,g)));return b}()},b.raw=function(){return m},g=b.define=function(a,b){var c,e;if(!d.isString(a))for(c in a)if(f.call(a,c))return e=a[c],g(c,e);h[a]=b},e=b.defaults=function(a,b){var c,g,h;if(!d.isString(a))for(c in a)if(f.call(a,c))return g=a[c],e(c,g);return h=d.get(a),null!=h?h:d.set(a,b)},k=b.namespace=function(a,b){var c,e,g,h,i;return h=a+"_",e=void 0,i=new RegExp(h+"(.+)"),c=d.attributes({get:function(a){return d.get(h+a)},set:function(a,b){return d.set(h+a,b)},all:function(){var a,b,c;b={};for(a in m)f.call(m,a)&&(c=m[a],e=a.match(i),null!=e&&(b[e[1]]=c));return b},values:b}),g=void 0,c.change=function(a){g||(g=[],d.on("data:change",function(b){var c,d;if(e=b.key.match(i),null!=e)for(c=0,d=g.length;d>c;c++)(a=g[c])(b)})),g.push(a)},c},b.user_attr=k("user_attr"),b.page_attr=k("page_attr"),a("routes").simple("set",d.set),a("routes").simple("get",d.get),a("routes").simple("append",d.append),a("routes").regexp(/data:(.+)/,function(a,b){return k(a[1],b)}),l=c.navigator,j=l.language||l.browserLanguage||l.userLanguage||l.systemLanguage,j&&(j=j.replace("_","-"),j=j.toLowerCase()),b.user_attr("kx_lang",j),b.user_attr("kx_tech_browser_language",j)}),a("dataprovider",function(a,b){var c,d,e,f,g;e=a("http"),c=a("util"),g=b.userMatch=function(a,b,d){return e.pixel({url:c.get("url_um"),data:{partner:a,r:b,_kdpid:d}})},d=b.exelate=function(){return g("exelate","//loadm.exelator.com/load/","e4942ff0-4070-4896-a7ef-e6a5a30ce9f9")},f=a("routes"),f.simple("dataprovider.exelate",d)}),a("dom-iframe",function(a,b){var c,d;c=window,d=a("util"),b.IFrame=function(){var b,e;return b=function(b){var c;c=a("dom"),this.options=d.extend({},e,b||{}),this.node=c.createElement("iframe",this.options.attr),"function"==typeof this.options.onload&&c.onload(this.node,this.options.onload),this.insert(),this.options.attr.src&&!this.options.html||this.html(this.options.html||"")},e={target:null,targetAction:"append",html:"",attr:{}},b.prototype={insert:function(){var d,e,f;e=this.options,d=e.targetAction,f=e.target||c.document.body,a("dom").insert(d,f,this.node),this.win=b.window(this.node),this.doc=b.document(this.node)},html:function(a){var b;b=this.doc,a.match(/^<html>/)||(a="<html><head></head><body>"+a+"</body></html>"),b.open(),b.write(a),b.close()}},b.window=function(a){return a.contentWindow},b.document=function(a){return b.window(a).document},b}()});var f={}.hasOwnProperty,d=function(a,b){return function(){return a.apply(b,arguments)}},c=[].slice;a("dom",function(a,b){var e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q;for(e=window,i=a("util"),I=a("sniff"),K=[a("dom-iframe"),I],o=e.document,H=e.setTimeout,g=o.documentElement.attachEvent?"attachEvent":"addEventListener",x=0,A=K.length;A>x;x++){J=K[x];for(z in J)f.call(J,z)&&(P=J[z],b[z]=P)}b.browserBucket=I.bucket,G=new i.Set(["area","base","basefont","br","col","frame","hr","img","input","isindex","link","meta","param","embed"]),y=function(a){return!!G[a]},l=b.attr=function(a,b,c){var d,e;if(e="",void 0!==c)return a.setAttribute(b,c),a;try{return a.getAttribute(b)||null!=(d=a.attributes[b])&&d.value||e}catch(f){return e}},b.removeAttr=function(a,b){return a.removeAttr(b)},M=b.text=function(a){return a.innerText||a.textContent},b.value=function(a){switch(a.nodeName){case"INPUT":return l(a,"value");case"TEXTAREA":return M(a)}},b.StringStream=h=function(){function a(){var a;return a=1<=arguments.length?c.call(arguments,0):[],this.stream=d(this.stream,this),this.data=d(this.data,this),this._buffer=a,this.stream.data=this.data,this.stream}return a.prototype.data=function(){return this._buffer.join("")},a.prototype.stream=function(){var a,b;return a=1<=arguments.length?c.call(arguments,0):[],(b=this._buffer).push.apply(b,a)},a}(),Q=function(a,b,c){var d,e,g,j,k,l,m,n;null==b&&(b=new h),null==c&&(c=0),j=i.defaults(a,{attributes:{},children:[]}),n=j.tagName,d=j.attributes,g=j.children,m=y(n),b("<",n);for(z in d)f.call(d,z)&&(P=d[z],b(" ",z,'="',P,'"'));if(m)return b("/>"),b;if(b(">"),"string"==typeof g)b(g);else for(k=0,l=g.length;l>k;k++)e=g[k],Q(e,b,c+1);return b("</",n,">"),b},n=function(a,b,c){var d;return null==b&&(b={}),null==c&&(c=[]),d="string"!=typeof a?a:{tagName:a,attributes:b,children:c},Q(d).data()},w=function(a){var b;return b=o.createElement("div"),b.innerHTML=a,b.childNodes},v=function(a){return w(a)[0]},b.byId=function(a){return(null!=a?a.nodeType:void 0)?a:o.getElementById(a)},u=b.head=function(a){return null==a&&(a=o),a.head||a.getElementsByTagName("head")[0]},b.document=function(a){return a.document||a.ownerDocument||a},b.window=function(a){var c;return c=b.document(a),c.parentWindow||c.defaultView},b.create=b.createElement=function(){var a;return a=1<=arguments.length?c.call(arguments,0):[],v(n.apply(null,a))},F=b.remove=function(a){a.parentNode.removeChild(a)},b.isNode=function(a){return!!a.nodeType},m=b.before=function(a,b){a.parentNode.insertBefore(b,a)},k=b.append=function(a,b){a.appendChild(b)},b.after=function(a,b){var c;return c=a.nextSibling,c?m(c,b):k(a.parentNode,b)},b.prepend=function(a,b){var c;return c=a.firstChild,c?m(c,b):k(a,b)},b.insert=function(a,c,d){return 3===arguments.length?b[a](c,d):(d=a,m(o.getElementsByTagName("script")[0],d))},b.replace=function(a,b){return m(a,b),F(a)},b.scriptEval=function(a){var b;b=o.createElement("script"),b.text=a,u(o).appendChild(b)},b.winEval=function(a,b){var c;return a.kxeval||(c="(function(){,\n  var win = this;,\n  win.kxeval = win.execScript ? ,\n    function(expr){return win.execScript(expr);} :,\n    function(expr){return win.eval(expr);};,\n})();",a.execScript?a.execScript(c):a.eval(c)),a.kxeval(b)},b.childElements=function(a){var b,c,d,e,f;for(c=[],f=a.childNodes,d=0,e=f.length;e>d;d++)b=f[d],1===b.nodeType&&c.push(b);return c},b.onload=function(a,b){var c,d,e,h,j,k,l;"function"==typeof b&&(b={done:b}),c=b.done,h=b.fail,c=i.once(c||i.noop),h=i.once(h||i.noop),l=function(){return a.readyState&&a.readyState.match(/complete|loaded/)?c():void 0},e={load:c,error:h,readystatechange:l},k=a.attachEvent?"on":"";for(d in e)f.call(e,d)&&(j=e[d],a[g](k+d,j,!0))},t="_krux_hash",s=1,r=b.hash=function(a){return a[t]||(a[t]=s++)},B={},b.meta=function(a){var b;return b=r(a),B[b]||(B[b]={node:a,hash:b})},a("events"),D=!!e.window.attachEvent,j=b._on_=D?"attachEvent":"addEventListener",O=b.type={ready:{target:e.document},load:{target:e},unload:{target:e},beforeunload:{target:e}},E=b.on=function(a,b,c,d){b=D?"on"+b:b,a[j](b,c,d||!1)},b.d2on=e.addEventListener?function(a,b,c){return a.addEventListener(b,c,!1),{remove:function(){a.removeEventListener(b,c)}}}:function(a,b,c){return a.attachEvent(b,c),{remove:function(){a.detachEvent(b,c)}}};for(C in O)f.call(O,C)&&(L=O[C],L.nativeName="ready"!==C?C:D?"readystatechanged":"DOMContentLoaded",b[C]=function(a){return function(b){i.onOnce("dom:"+a,b)}}(C));if(q=function(a,b){return null==b&&(b=void 0),"load"!==a?function(){i.fireOnce("dom:"+a,b)}:function(){i.fireOnce("dom:ready",b),i.fireOnce("dom:load",b)}},p=function(){try{o.documentElement.doScroll("left")}catch(a){return void H(p,1)}i.fireOnce("dom:ready")},b.createHead=function(c,d){var e,f,g;return g=a("sizzle"),(f=i.first(g.find('.kxhead[data-id="'+c+'"]')))?f:(b.kxhead=f=b.create("div",{"class":"kxhead","data-id":c,style:"display:none !important;"}),d?b.before(d,f):b.append(o.body,f),e=b.insert,b.insert=function(a){1===arguments.length?b.append(f,a):e.apply(b,arguments)},f)},b.addStylesheet=function(a){var c;if(null!=a)return c=e.document.createElement("link"),c.rel="stylesheet",c.type="text/css",c.href=a,b.append(b.head(e.document),c)},b.baseDomain=function(a){var b;return b=String(a).replace(/:\d+$/,""),/(?:\d{1,3}\.){3}\d{1,3}/.test(b)?"":b.replace(/.*?((?:(^|\.)[^\.]+){1,2}(?:\.com)?)$/,"$1").replace(/^\./,"")},b.safeMode=function(){return e.location.href.indexOf("krux_safe")>-1||I.ie&&I.version<8||I.ff&&I.version<4||!e.document.readyState||function(){var a;try{return null==(null!=(a=e.JSON)&&"function"==typeof a.parse?a.parse("true"):void 0)}catch(b){return!0}}()},/^(complete|loaded)$/.test(e.document.readyState))q("load")();else{if(I.ie){E(e,O.load.nativeName,q("ready")),N=!1;try{N=null==e.window.frameElement}catch(R){}o.documentElement.doScroll&&N&&p()}for(C in O)f.call(O,C)&&(L=O[C],E(L.target,L.nativeName,q(C),!1))}H(function(){return q("load",{timedout:!0})},6e3)});var d=function(a,b){return function(){return a.apply(b,arguments)}};a("events",function(a,b){var c,e,f,g,h,i,j;for(e=a("util"),b.Events=c=function(){function a(){this.clear=d(this.clear,this),this.happened=d(this.happened,this),this.onOnceAll=d(this.onOnceAll,this),this.fireOnce=d(this.fireOnce,this),this.onOnce=d(this.onOnce,this),this.fire=d(this.fire,this),this.off=d(this.off,this),this.on=d(this.on,this),this._handlers={ALL:[]},this._happened={}}return a.prototype.on=function(a,b){e.isString(a)?(null==this._handlers[a]&&(this._handlers[a]=[]),this._handlers[a].push(b)):e.isFunction(a)?this._handlers.ALL.push(a):this.on(function(c){a.test(c.type)&&b(c)})},a.prototype.off=function(a,b){this._handlers[a]=b?e.remove(this._handlers[a],b):[]},a.prototype.fire=function(a,b){var c,d,f,g,h,i,j;if(b=b||{},b.type||(b.type=a),this._happened[a]=b,"data:change"!==b.type&&e.log(b),null!=this._handlers[a])for(i=this._handlers[a],d=0,g=i.length;g>d;d++)(c=i[d])(b);if(null!=this._handlers.ALL)for(j=this._handlers.ALL,f=0,h=j.length;h>f;f++)(c=j[f])(b);return b},a.prototype.onOnce=function(a,b){var c;return(c=this._happened[a])?e.defer(b,c):this.on(a,e.once(b))},a.prototype.fireOnce=function(a,b){return!this._happened[a]&&this.fire(a,b)},a.prototype.onOnceAll=function(a,b){var c,d,f,g;for(a=a.split(" "),b=e.once(b),c=function(c){return function(){var d,e,f;for(d=0,e=a.length;e>d;d++)if(f=a[d],!c._happened[f])return;b()}}(this),d=0,f=a.length;f>d;d++)g=a[d],this.onOnce(g,c)},a.prototype.happened=function(a){return this._happened[a]},a.prototype.clear=function(a){var b,c,d;c=this._happened,this._happened={};for(b in c)d=c[b],a&&0!==b.indexOf(a)&&(this._happened[b]=d)},a}(),g=b.instance=new c,j=["on","off","fire","onOnce","fireOnce","onOnceAll","happened"],f=0,h=j.length;h>f;f++)i=j[f],e[i]=g[i]}),a("expression",function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;for(c=a("util"),f=a("data"),x=a("store"),o=a("tag-delivery").isIdDelivered,n=c.isArray,p=c.isString,g={},h={},l=b.getDelimiter=function(a){return c.get(a+"DELIM")},w=b.setDelimiter=function(a,b){l(a)!==b&&f.setSilently(a+"DELIM",b)},k=b.get=function(a,b){var d;return d=c.get(a),b&&w(a,b),b=l(a),c.isArray(d)?d:b?d?d.split(b):[]:d},u=b.parse=function(a){var b,d,e,f,g,h,i,j,l,m;switch(!1){case!!c.isString(a):return a;case!(g=a.match(/^\$([^:]+)(?::(.*))?$/)):return k(g[1],g[2]);case!(g=a.match(/^\[\s*((?:"|').*(?:"|'))\s*]$/)):for(i=g[1].replace(/(?:^\s*["'])|(?:["']\s*$)/g,"").split(/(?:['"]\s*,\s*['"])/),l=[],b=0,e=i.length;e>b;b++)h=i[b],l.push(u(h));return l;case!(g=a.match(/^\[\s*(.*)\s*]$/)):for(j=g[1].split(/\s*,\s*/),m=[],d=0,f=j.length;f>d;d++)h=j[d],m.push(u(h));return m;case!(g=a.match(/^"(.*)"$/)):return decodeURIComponent(g[1]);default:return a}},j=function(a){var b;return b=i(a),null!=b?g[b]||h[b]:void 0},e=function(a,b){var d,e,f,g,h;switch(!1){case!b.isMacro:return a.slice(1);case!!c.isFunction(b):return a;default:for(f=a.slice(1),g=[],d=0,e=f.length;e>d;d++)h=f[d],g.push(i(h));return g}},d=function(a){var b;return b=j(a[0]),b.apply(this,e(a,b))},i=b.eval=function(a){switch(!1){case!(n(a)&&0===a.length):return!0;case!(n(a)&&c.isFunction(j(a[0]))):return d(a);case!p(a):return u(a);default:return a}},c.extend(g,{afterTag:o,beforeTag:c.negate(o),contains:function(a,b){var d;return null==a&&(a=[]),d=(""+b).toLowerCase(),c.isArray(a)?c.any(a,function(a){return(""+a).toLowerCase()===d}):-1!==(""+a).toLowerCase().indexOf(d)},endsWith:function(a,b){return g.matches(a,c.escapeRegexp(b)+"$")},intersection:c.intersection,intersects:function(a,b){return a=c.isArray(a)?a:[a],b=c.isArray(b)?b:[b],c.any(a,function(a){return g.contains(b,a)})},is:function(a,b){return c.isString(a)?a.toLowerCase()===String(b).toLowerCase():a===b},matches:function(a,b){try{return new RegExp(b).test(a)}catch(c){return!1}},memberOf:function(a,b){return g.contains(b,a)},now:function(){return new Date},random:function(){return Math.random()},startsWith:function(a,b){return g.matches(a,"^"+c.escapeRegexp(b))}}),s=function(a){switch(a){case"<":return function(a,b){return b>a};case">":return function(a,b){return a>b};case"<=":return function(a,b){return b>=a};case">=":return function(a,b){return a>=b};case"==":return function(a,b){return a===b};case"!=":return function(a,b){return a!==b};default:return function(){return!1}}},v=["<",">","<=",">=","==","!="],m=0,q=v.length;q>m;m++)y=v[m],g[y]=s(y);c.extend(g,{isnt:c.negate(g.is),isNot:c.negate(g.is),notContains:c.negate(g.contains),notIntersects:c.negate(g.intersects),notMemberOf:c.negate(g.memberOf)}),c.extend(h,{and:function(){return c.every(arguments,i)},or:function(){return c.any(arguments,i)}}),c.extend(h,{andNot:c.negate(h.or)});for(t in h)r=h[t],r.isMacro=!0}),a("feature",function(a){var b;return b=a("sniff"),{hasThirdPartyCookies:function(){return b.is!==b.Browsers.SAFARI},hasLocalStorage:function(){var a;a=!1;try{localStorage.setItem("kxtest","test"),a="test"===localStorage.getItem("kxtest"),localStorage.removeItem("kxtest")}catch(b){}return a}}});var g=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};a("fingerprint-scraper",function(a,b){var c,d,e,f,h;c=a("util"),d=b.all=function(a,b){var d,e,f,g;null==b&&(b=c.yes),f=c.deref(a),e=[];for(d in f)g=f[d],b(g,d,f)&&null!=g&&e.push(g);return e},b.path=c.deref,e=function(a){return function(b,c){return a(b,function(a,b){return g.call(c,b)>=0})}},b.keys=e(d),f=b.pluckAll=function(a,b){var d,e,f,g,h,i,j;for(null==b&&(b=c.yes),d=c.deref(a),d.length||(d=c.values(d)),i=[],e=0,g=d.length;g>e;e++){h=d[e];for(f in h)j=h[f],h.hasOwnProperty(f)&&b(j,f,h)&&i.push(j)}return i},h=b.pluckKeys=e(f),b.pluckKeysWhere=function(a,b,c){var d,e,f,g,i,j;for(g=h(a,b),i=[],d=e=0,f=g.length;f>e;d=++e)j=g[d],c(j,d,g)&&i.push(j);return i},b.primitives=c.partial(d,c._,c.isPrimitive),b.serializable=c.partial(d,c._,c.isSerializable)}),a("fingerprint",function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n;return d=a("util"),e=a("cache"),j=a("fingerprint-scraper"),m=a("sha1"),c=a("privacy").USER_ID_TTL,a("data"),h=d.partial(j.keys,"navigator"),k=d.partial(j.keys,"screen"),n=function(a){return a[0]*a[1]},l=d.compose(k,n),b.mimeTypes=d.partial(j.pluckKeysWhere,"navigator.mimeTypes",["type","description","suffixes"],function(a){return""!==a&&d.isString(a)||d.isNumber(a)&&!d.isNaN(a)}),b.navigatorPrimitives=d.partial(h,["onLine","product","appCodeName","platform","appVersion","appName","vendorSub","vendor","productSub","cookieEnabled","language"]),b.plugins=d.partial(j.pluckKeys,"navigator.plugins",["name","filename","description"]),b.screenDepth=d.partial(k,["pixelDepth","colorDepth"]),b.screenResolution=d.partial(l,["availWidth","availHeight"]),b.screenSize=d.partial(l,["width","height"]),b.timezone=function(){return[(new Date).getTimezoneOffset()]},b.ua=function(){var a;return a=j.path("navigator.userAgent"),[String(a).replace(/([a-z0-9]){8}\-(\1{4})\-\2\-\2\-\1{12}/i,"")]},i=function(){var a,c,d,e;d=[];for(a in b){c=b[a];try{e=c(),d.push.apply(d,e)}catch(f){}}return d},f=function(){return m(i().sort().join(""))},g=function(a){var b,g;return g=a.get("fp_id"),b=e(f,{ttl:30*d.MINUTES})(),d.set("fp",b),a.set("fp",b,c),d.set("fp_id",g),d.onOnce("user_data_response",function(b){return b.kfuid?(d.set("fp_id",b.kfuid),a.set("fp_id",b.kfuid,c)):void 0}),b},d.extend(g,b,{raw:i})}),a("flash",function(a,b){var c,d,e,f;c=window,d=function(a){try{return a.GetVariable("$version")}catch(b){}return""},e=function(a){var b;return b=a.split(","),{installed:!0,raw:a,major:parseInt(b[0].split(" ")[1],10),minor:parseInt(b[1],10),revision:parseInt(b[2],10),revisionStr:b[2]}},f=function(a){var b,c,d;return b=a.split(RegExp(" +")),c=b[2].split(/\./),d=b[3],{installed:!0,raw:a,major:parseInt(c[0],10),minor:parseInt(c[1],10),revision:parseInt(d.replace(/[a-zA-Z]/g,""),10)||d,revisionStr:d}},b.version=function(){var b,g,h;if(b=a("util"),h="",g=null,null!=c.navigator.plugins&&c.navigator.plugins.length>0){if(h=b.deref(c.navigator,"mimeTypes.application/x-shockwave-flash.enabledPlugin.description"))return f(h)}else if(-1===c.navigator.appVersion.indexOf("Mac")&&null!=window.execScript){try{g=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),h="6,0,21",g.AllowScriptAccess="always",h=d(g)}catch(i){}try{g=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),h=d(g)}catch(i){}if(h)return e(h)}return{installed:!1,raw:"",major:"",minor:"",revision:"",revisionStr:""}}});var f={}.hasOwnProperty;a("geo",function(a,b){var c,d,e,g,h,i,j,k,l,m,n,o;return d=window,g=a("util"),h=a("config"),m=a("privacy"),n=a("store"),a("data"),a("events"),e=24*g.HOURS,k=function(a){return String(a).toLowerCase()},l=function(a){var b,c,d;for(b in a)f.call(a,b)&&(d=a[b],c=k(b),c!==b&&(delete a[b],a[c]=d));return a},i=function(a){var b,c,d,e;for(e=["country","region","city","dma"],b=0,d=e.length;d>b;b++)c=e[b],g.set("user_attr_kx_geo_"+c,a[c]||a[c.toUpperCase()])},o=function(a){"function"==typeof n.set&&n.set("geo",g.paramString(a),e)},j=function(){return n.impl?g.parseParams(n.get("geo")):{}},c="geo",b=g.extend(function(){var a,e,i,k,l;if(e=h(),e.get("params.no_pii")||m.isOptOut()){for(i in b)f.call(b,i)&&(k=b[i],g.isFunction(k)&&(b[i]=g.noop));return e.set(c,{}),b}return l=e.get(c),g.isString(l)&&e.set(c,l=d.JSON.parse(l)),g.isEmpty(l)?(g.on("user_data_response",function(a){var c;c=(a||{}).geo||{},o(c),b.receive(c)}),a=j(),g.isEmpty(a)||b.receive(a)):(b.receive(l),o(l)),b},{get:function(a){var b;return b=g.get(c)||{},a?b[k(a)]:b},set:function(a,d){return null!=d?g.get(c)[k(a)]=d:g.set(c,l(a)),b},receive:function(a){return b.set(a),i(a),g.fireOnce("geo:ready",b),b}})});var c=[].slice;a("hash-set",function(a){var b,d;return d=a("util"),b=function(){function a(){var a,b;a=arguments[0],b=2<=arguments.length?c.call(arguments,1):[],this._hash=function(b){var c;return c=d.isFunction(a)?a(b):b,String(void 0!==c?c:b)},this._q=[],this.put.apply(this,b),this._items={}}return a.prototype.put=function(){var a,b;return a=1<=arguments.length?c.call(arguments,0):[],(b=this._q).push.apply(b,a),this},a.prototype.get=function(a){return this._thunk(),this._items[this._hash(a)]},a.prototype.has=function(a){return this._thunk(),this._hash(a)in this._items},a.prototype.remove=function(){var a,b,d,e;for(d=1<=arguments.length?c.call(arguments,0):[],this._thunk(),a=0,e=d.length;e>a;a++)b=d[a],delete this._items[this._hash(b)];return this},a.prototype.toArray=function(){var a,b,c,d;this._thunk(),b=this._items,c=[];for(a in b)d=b[a],c.push(d);return c},a.prototype.fromArray=function(a){return this.put.apply(this,a),this},a.prototype.toString=function(){var a;return this._thunk(),function(){var b;b=[];for(a in this._items)b.push(a);return b}.call(this).join(",")},a.prototype.empty=function(){return this._q=[],this._items={},this},a.prototype.size=function(){var a;return this._thunk(),function(){var b;b=[];for(a in this._items)b.push(a);return b}.call(this).length},a.prototype._thunk=function(){var a,b,c,d;for(d=this._q.splice(0,this._q.length),a=0,c=d.length;c>a;a++)b=d[a],this._items[this._hash(b)]=b;return this},a}(),d.extend(function(){var a,d,e;return d=arguments[0],e=2<=arguments.length?c.call(arguments,1):[],a=new b(d),a.put.apply(a,e),a},{HashSet:b})}),a("http-jsonp",function(a,b){var c,d,e,f,g,h,i;c=window,g=c.document,e=a("util"),i=a("ns"),h=null!=(f=i.self).inFlightKeys?f.inFlightKeys:f.inFlightKeys={},b.Request=d=function(){function b(c){var d,e;if(null==c.data&&(c.data={}),this.options=c,!c.callback)throw new Error("Callback name is required");for(d in c)e=c[d],this[d]=e;this.self&&(this.done=function(a){var b;return(b=this.self).done.apply(b,a)},this.fail=function(a){var b;return(b=this.self).fail.apply(b,a)}),this.plantReceiver(),this.src=a("http").src(this),b.all.push(this)}return b.all=[],b.prototype.fail=function(a){var b;b=a&&a.status||"unknown",e.fire("error",{message:"jsonp failed with status "+b+" src: "+this.src})},b.prototype.done=function(){},b.prototype.receive=function(a){return this.time.end=new Date,a.status?"200"===String(a.status)?this.done(a.body):this.fail(a):this.done(a)},b.prototype.plantReceiver=function(){var a;a=this.options.callback,this.data.callback=i.path+"."+a,h[a]=h[a]||0,h[a]++,i.self[a]=function(b){return function(){h[a]--,0===h[a]&&delete i.self[a],b.receive.apply(b,arguments)}}(this)},b.prototype.sendInline=function(){var a;return a='<script src="'+this.src+'" type="text/javascript"></script>',g.write(a),this},b.prototype.send=function(){var a,b;return this.time={start:new Date},this.inline?this.sendInline():(a=g.createElement("script"),a.type="text/javascript",a.src=this.src,b=g.getElementsByTagName("script")[0],b.parentNode.insertBefore(a,b),this)},b.clear=function(){return b.all=[]},b}(),b.call=function(a){return new d(a).send()},b.clear=d.clear});var f={}.hasOwnProperty;a("http",function(a,b){var c,d,e,g,h,i,j,k,l,m,n,o,p,q;c=window,e=a("util"),j=a("feature"),n=a("sniff"),q=a("uuid"),m=b.protocol="https:"===c.location.protocol?"https:":"http:",d=b.REQUEST_ID_KEY="request_id",b.maxUrlLength=n.is===n.Browsers.IE?2030:8e3,l=b.param=function(a,b){var d;return d=e.isString(b)||e.isNumber(b)?b:c.JSON.stringify(b),encodeURIComponent(a)+"="+encodeURIComponent(d)},p=function(a,b){return a.match(/^\/\//)&&(a=m+a),b.length>0?a+"?"+b.join("&"):a},k=e.compose(function(a){return a.length>b.maxUrlLength},p),i=function(a,b){return[d+"="+b].concat(a)},h=function(a){return a+"&pageview=false"},g=function(b){return a("data"),a("config")().get("params.first_party_uid",!1)&&!j.hasThirdPartyCookies()&&(null==b.data&&(b.data={}),b.data._kuid=e.get("user")),b},o=b.srcs=function(a){var b,c,d,g,h,j,m,n,o,r,s,t,u;if(a=e.clone(a),t=a.url=a.url||"no_url",o=q(),s=e.partial(p,t),c=e.partial(k,t),m=function(){var b,c;b=a.data,c=[];for(g in b)f.call(b,g)&&(u=b[g],null!=u&&""!==u&&c.push(l(g,u)));return c}(),a.noClip)return[s(m)];for(b=function(a,d){var e;for(d=d||[],e=[],a=i(a,o);c(a)&&a.length;)e.push(a.pop());return d.push(a),e.length>0&&a.length>0?b(e,d):(1===d.length&&d[0].shift(),d)},n=b(m),r=[],d=0,h=n.length;h>d;d++)j=n[d],r.push(s(j));return r},b.src=function(a){var c;return c=o(a),c.length>1&&e.fire("http:error",{code:"overflow",message:"Too many params for a single URL (max = "+b.maxUrlLength+").\nUsing first URL chunk; use http#srcs instead to handle long URLs"}),e.head(c)},b.willClip=function(a){var c;return c=b.src(e.extend({noClip:!0},a)),c.length>b.maxUrlLength&&c.length-b.maxUrlLength},b.pixel=function(a){var b,d,f,i,j;try{for(i=o(g(a)),b=d=0,f=i.length;f>d;b=++d)j=i[b],(new c.Image).src=b>0?h(j):j;e.fire("http:pixel",a)}catch(k){}},b.ping=function(a){var b,d,e,h;try{d=g(a),e=function(){var a,c;a=d.data,c=[];for(b in a)f.call(a,b)&&(h=a[b],null!=h&&""!==h&&c.push(l(b,h)));return c}(),(new c.Image).src=p(d.url,e)}catch(i){}},b.jsonp=function(b){return a("http-jsonp").call(g(b))},b.clearRequestList=function(){return a("http-jsonp").clear()}}),a("impression",function(a,b){var c,d,e;c=a("util"),d=a("pixel"),a("data"),e=b.send=function(a){c.set("url_pixel",a.url),d.sendImpl(a)},b.init=function(a){e(a)}}),a("index",function(a){var b,c,d,e;return b=window,null==(d=null!=b.Krux?b.Krux:b.Krux=function(){b.Krux.q.push(arguments)}).q&&(d.q=[]),c=b.Krux,e=b.postscribe,b.postscribe=null,a("postscribe"),c.postscribe=b.postscribe,b.postscribe=e,!c.commit||c.ns?(null==c.commit&&(c.commit=1),b.Krux=function(d,e){var f,g,h;if(null==e.params&&(e.params={}),g=e.params.control_tag_namespace,b.Krux=c,f=a("ns").init(g,function(){return a("routes").call}))switch(!1){case"proxy"!==(null!=(h=c.q[0])?h[0]:void 0):c.q.shift(),a("proxy").server(e);break;case"marketer"!==e.params.client_type:a("marketer")(f,e);break;default:a("publisher")(f,e)}}):void 0}),a("jslog",function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;c=window,d=a("util"),g=a("dom"),l=a("http"),p=a("sniff"),f=c.location.search.indexOf("kxdebug")>-1,i=[],o=[],k=function(a){if(c.console&&f,d.happened("jslog.pixel")){if(a.msg===o[o.length-1])return;if(o.length>10*Math.random())return;o.push(a.msg),a.type+="-postload",i.push(a),l.pixel(j()),i=[]}else i.push(a)},n=function(a){var b;return b=/https*:\/\/([^\/]+)\/([^?\/]+)/.exec(a),b&&"apiservices.krxd.net"===b[1]?"service:"+b[2]:b&&b[1].indexOf("krxd.net")>-1?"controltag":""},h=b.errorTypes=["controltag","tag","test","http","js"],m=c.onerror||function(){return!1},c.onerror=function(a,b,d){var e,f,g;try{return"string"!=typeof a?m.apply(c,arguments):(g=n(b)||"js",k({type:g,url:b,line:d,msg:a}),m.apply(c,arguments))}catch(f){e=f,c.console}return m.apply(c,arguments)},q=b.sortByPriority=function(a){var b;return b=function(a){var b;return b=d.indexOf(h,a.type),-1!==b?b:h.length},d.clone(a).sort(function(a,c){var d,e;return d=b(a),e=b(c),e>d?-1:d>e?1:0})},d.on("tag:fail",function(a){k({type:"tag",tagid:a.id,msg:a.error})}),d.on("test:fail",function(a){k({type:"test",msg:a.code+":"+a.data})}),e=void 0,j=b.getPixelOptions=function(a){var b,f;for(b=a||{url:d.get("url_log"),data:{control_tag_version:c.Krux.version,
commit:c.Krux.commit,pubid:d.get("pubid"),siteid:d.get("siteid"),site_name:d.get("site"),browser_bucket:p.bucket,version_bucket:e,lang:p.lang,log_version:1.1,errors:q(i)}},f=b.data.errors;l.willClip(b)&&f.length;)f.pop();return b},d.on("test:all_done",function(){var a;a="alpha"===d.get("config_param_control_tag_version")?1:.1,i.length>0&&d.rate(a)&&(l.pixel(j()),d.fire("jslog.pixel",{errors:i.length}),i=[])}),d.on("http:error",function(a){k({type:"http",msg:a.code+": "+a.message})})}),a("json",function(){return{stringify:function(a,b){return null==b&&(b=""),null!=a?window.JSON.stringify(a):b},parse:function(a,b){return null==b&&(b={}),null!=a&&""!==a?window.JSON.parse(a):b}}}),a("krux-uid",function(a){var b,c,d,e,f;return d=a("util"),f=a("mersenne-twister"),b=function(){function a(a){var b,c,d,e,f;for(this.charMap=a,this._indexMap={},f=this.charMap,c=d=0,e=f.length;e>d;c=++d)b=f[c],this._indexMap[b]=c}return a.SHORT_ALPHABET=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","-","_"],a.LONG_ALPHABET=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"],a.SHORT_CODEC=new a(a.SHORT_ALPHABET),a.LONG_CODEC=new a(a.LONG_ALPHABET),a.prototype.encode=function(a){var b,c,d;for(c=this.charMap.length,b=[];a>0;)d=a%c,a=Math.floor(a/c),b.push(this.charMap[d]);return b.reverse().join("")},a.prototype.decode=function(a){var b,c,d,e,f,g;for(e=a.length,g=0,b=d=0,f=e;f>=0?f>d:d>f;b=f>=0?++d:--d){if(c=this._indexMap[a.charAt(b)],null==c)throw new Error("Cannot decode "+a+" as a KruxUID.");g+=c,e-1>b&&(g*=this.charMap.length)}return g},a}(),c=function(){function a(c){var e,g;null==c&&(c=""+d.now()+String(f()).substring(3,6),c=c.substring(1,c.length-1),c=Number(c)),this.uid=function(){var d,f;switch(!1){case"number"!=typeof c:return c;case!a.isFallback(c):return this._fallback=c,-1;default:try{return b.LONG_CODEC.decode(c)}catch(d){e=d;try{return b.SHORT_CODEC.decode(c)}catch(f){return g=f,this._fallback=c,-1}}}}.call(this)}return a.prototype._fallback=void 0,a._guidRe=/^[a-z0-9]{8}-(?:[a-z0-9]{4}-){3}[a-z0-9]{12}$/i,a._oldIpSeparator=".",a.prototype.toShortId=function(){return null!=this._fallback?this._fallback:b.SHORT_CODEC.encode(this.uid)},a.prototype.toLongId=function(){return null!=this._fallback?this._fallback:b.LONG_CODEC.encode(this.uid)},a.prototype.toNumericId=function(){return this.uid},a.isFallback=function(b){return a._guidRe.test(b)||-1!==("function"==typeof b.indexOf?b.indexOf(a._oldIpSeparator):void 0)},a.fromShort=function(c){return new a(a.isFallback(c)?c:b.SHORT_CODEC.decode(c))},a.fromLong=function(c){return new a(a.isFallback(c)?c:b.LONG_CODEC.decode(c))},a}(),e=function(a){return new c(a)},e.fromShort=c.fromShort,e.fromLong=c.fromLong,e}),a("kxinterchange",function(a){var b;b=window,function(){var c,d,e,f;f=function(a){var c,d,e,f;return e=function(){var a;try{return this.localStorage}catch(a){return c=a,null}}.call(this),d="kx"+a,((f=e)?f[d]||"":(f=b.document.cookie)&&(f=f.match("\\b"+d+"=([^;]*)"))&&decodeURIComponent(f[1]))||""},d=a("util"),c=b.Krux,e={Krux:{user:c.user,segments:c.segments,dartKeyValues:c.dartKeyValues},store:{user:f("user"),segs:f("segs")}},a("test").module("kxinterchange-support-snippet",function(a){var b,d,f,g,h,i;for(a.eq("Krux.user exported",e.Krux.user,e.store.user),h=e.store.segs,a.eq("Krux.segments exported",e.Krux.segments,h&&h.split(",")||[]),f=e.Krux.segments,b=0,d=f.length;d>b;b++)g=f[b],a("Krux.dartKeyValues contains segment "+g,c.dartKeyValues.indexOf("ksgmnt="+g)>=0);i=e.store.user,i&&a("Krux.dartKeyValues contains user",c.dartKeyValues.indexOf("u="+i)>=0)})}()}),a("marketer",function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;return d=window,f=a("util"),h=a("config"),i=a("dom"),j=a("feature"),k=a("fingerprint"),m=a("impression"),p=a("privacy"),q=a("proxy"),r=a("data-rewrite").tag,s=a("routes"),t=a("sizzle"),u=a("store"),v=a("tag"),w=a("timing"),x=a("krux-uid"),c="data-kx-id",e=/^https?:\/\/([a-z0-9_\-\.]+\.)?krxd\.net(:\d{1,5})?(\/|$)/i,g=function(a,b){return i.attr(b,c,a),b},l=b.getParams=function(a){return f.urlParams(i.attr(a,"src"))},o=b.next=function(a){var b;if(b=f.find(t.find("script[src*="+a+"]"),function(a){return!i.attr(a,c)&&e.test(a.src)}),!b)throw new Error("No node found for "+a);return b},n=function(b,c){var e,n,t,y,z,A,B,C,D,E,F,G,H,I;if(B=new Date,n=h(c),t=n.get("confid"),H=t+"-"+B.getTime(),w.start(),v.claimOneTimers(n.get("tags")),f.set("tags",n.get("tags")||[]),a("jslog"),y=a("data"),y.user_attr=y.namespace("user_attr"),y.page_attr=y.namespace("page_attr"),a("scrape"),a("dataprovider"),a("events"),A=g(H,o(t)),C=l(A),D=n.get("services"),!D||!D.impression)throw new Error("impression service not specified");return C.url=D.impression,f.set("confid",t),f.set("schema_version",n.get("app.schema_version")),f.set("pubid",f.get("pubid")||n.get("publisher.uuid")),n.get("params.no_pii")&&(f.set("pixel_data__knopii",1),y.user_attr("kx_lang",null),y.user_attr("kx_tech_browser_language",null)),a("test").init(),a("test-visualtags").init(),f.set("tags",n.get("tags")),f.set("config",n.toJSON()),f.set("version_bucket",n.get("params.control_tag_version")),f.set("max_segments",n.get("params.max_segments")),f.set("prioritized_segments",n.get("prioritized_segments")),y.namespace("url",n.get("services")),y.namespace("config_param",n.get("params")),z=!/localStorage/.test(f.get("config_param_client_side_storage")),E=a("store").init(z),a("segments"),p(),a("geo")(),i.safeMode()?(f.onOnce("dom:load",f.bind(f.fireOnce,null,"report")),void w.end()):(n.get("params.fingerprint")&&!p.isOptOut()&&k(u),n.get("params.first_party_uid")&&!j.hasThirdPartyCookies()&&(I=E.get("kuid")||x().toShortId(),f.set("user",I),p.storeKuid()),G=function(){var a,b,c,d;for(c=f.get("tags")||[],d=[],a=0,b=c.length;b>a;a++)F=c[a],d.push(r(F));return d}(),f.set("tags",G),f.set("config_segments",n.get("realtime_segments")),f.onOnceAll("dom:load tag:all_done",function(){f.fireOnce("report")}),e=a("adm-events"),e.parseConfig(n.get("realtime_segments",[])),e.check3rdParty(),a("stats"),a("social"),s.api(),n.has("context_terms")&&f.onOnce("dom:load",function(){a("context-terms").process(n.get("context_terms"))}),C._kpid=f.get("pubid"),m.init(C),n.get("params.store_realtime_segments",!1)&&q.client(function(a,b){if(null==a)try{return b.set("last_run",f.now())}catch(c){}}),d.setTimeout(v.init,250),void w.end())},f.extend(n,b)});var d=function(a,b){return function(){return a.apply(b,arguments)}};a("mersenne-twister",function(a){var b,c,e;return c=a("util"),b=function(){function a(b){var e,f,g,h,i,j;for(null==b&&(b=c.now()),this.next=d(this.next,this),e=a.MATRIX_A,f=a.N,g=a.WORD_MASK,this.mt=[b&g],this.mag01=[0,e],h=i=1,j=f;j>=1?j>=i:i>=j;h=j>=1?++i:--i)this.mt[h]=1812433253*(this.mt[h-1]^this.mt[h-1]>>>30)+h;this.mti=h}return a.N=624,a.M=624,a.MATRIX_A=2567483615,a.UPPER_MASK=2147483648,a.LOWER_MASK=2147483647,a.WORD_MASK=4294967295,a.TEMPERING_MASK_B=2636928640,a.TEMPERING_MASK_C=4022730752,a.prototype.mt=[],a.prototype.mti=0,a.prototype.mag01=[],a.prototype.next=function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;if(c=a.M,d=a.N,e=a.TEMPERING_MASK_B,f=a.TEMPERING_MASK_C,g=a.UPPER_MASK,b=a.LOWER_MASK,l=this.mag01,m=this.mt,q=0,this.mti>=d){for(h=j=0,n=d-c;n>=0?n>=j:j>=n;h=n>=0?++j:--j)q=m[h]&g|m[h+1]&b,m[h]=m[h+c]^q>>>1^l[1&q];for(i=k=o=h,p=d-1;p>=o?p>=k:k>=p;i=p>=o?++k:--k)q=m[i]&g|m[i+1]&b,m[i]=m[i+(c-d)]^q>>>1^l[1&q];q=m[d-1]&g|m[0]&b,m[d-1]=m[c-1]^q>>>1^l[1&q],this.mti=0}return q=m[this.mti+=1],q^=q>>>11,q^=q<<7&e,q^=q<<15&f,q^=q>>>18},a}(),e=new b,c.extend(e.next,{MersenneTwister:b})}),a("ns",function(b,c){var d,e,f,g,h,i,j,k;e=window,h=b("util"),k=b("version"),f=e.Krux,g=c.NS_RE=/^ns:([\w\W]+)/,d=c.DEFAULT_NS="_default",j=c.parseArgs=j=function(a){var b,c,e;return c=a[0],e=void 0,b=c.match(g),b?(c=b[1],e=h.rest(a)):(c=d,e=a),{nsName:c,rest:e}},i=function(c){var d;return d={version:k.version,commit:k.commit,require:b,define:a,_:h},h.extend(c,d),c.isDefault&&h.extend(e.Krux,d),c},c.router=f.nsRouter||function(){var a;return a=function(){var b,c;return b=j(arguments),c=a.ns[b.nsName],b.rest.length?c?c.apply(c,b.rest):void a.q.push(arguments):c},a.ns={},a.q=[],a.defineNamespace=function(b,c){var e,f,g,i,j,k;if(g=b||d,a.ns[g])return a.ns[g];for(j=a.ns[g]=c(b),h.extend(j,{nsName:g,isDefault:g===d,path:"Krux.ns."+g}),a.creator=a.creator||j,k=a.q.splice(0,a.q.length),f=0,i=k.length;i>f;f++)e=k[f],a.apply(null,e);return j},a.nsRouter=a,h.extend(a,f),e.Krux=a}(),c.init=function(a,b){var d;return d=c.self=c.router.defineNamespace(a,b),d&&(c.name=d.nsName,c.isDefault=d.isDefault,c.path=d.path,i(d)),d}});var f={}.hasOwnProperty;a("pixel",function(a,b){var c,d,e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;c=window,e=a("util"),p=a("http"),i=a("config")(),k=a("dom"),j=a("data"),l=a("feature"),u=a("sniff"),v=a("store"),q=a("privacy"),d=c.Krux,s=b.sendImpl=function(a){var b,c,d,g,h;c={};for(b in a)f.call(a,b)&&(h=a[b],(h=m(b,h))&&(c[b]=h));g=e.get("config_param_control_tag_pixel_throttle"),d=100*Math.random(),g&&d>g||(p.pixel({url:e.get("url_pixel"),data:c}),setTimeout(function(){var a;return(null!=(a=e.get("user"))?a.length:void 0)>0?void 0:q.fetch()},500))},w=b.stringifyValue=function(a){var b;return null==a&&(a=""),e.isArray(a)?function(){var c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],null!=b&&e.push(w(b));return e}().join(h):String(a)},n=b.formatters=[],g=b.addFormatter=function(a,b){n.push({test:a,formatter:b})},m=b.format=function(a,b){var c,d,e,f,g,h;for(e=void 0,g=0,h=n.length;h>g;g++)if(d=n[g],("function"==typeof(c=d.test).test?c.test(a):void 0)||d.test===a){e=d;break}return(f=(null!=e?e.formatter:void 0)||w)(b)},b.tuppleSeparator=":",h=b.arraySeparator=",",r=b.send=function(a,b){var c;c=o(a,b),s(c),e.fireOnce("pixel",{phase:a,data:c})},o=b.gather=function(b,h){var k,m,n,o,p,q,r,s,t,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T;C={source:"smarttag",fired:b,confid:e.get("confid"),_kpid:e.get("pubid"),_kcp_s:e.get("site"),_kcp_sc:e.get("section"),_kcp_ssc:e.get("subsection"),_kcp_d:e.get("domain"),_knifr:c.frames.length,_kpref_:c.document.referrer},h===!1&&(C.pageview=String(h)),1!==e.get("pixel_data__knopii")&&(C._kua_kx_tz=(new Date).getTimezoneOffset(),C.geo_country=e.get("user_attr_kx_geo_country"),C.geo_region=e.get("user_attr_kx_geo_region"),C.geo_city=e.get("user_attr_kx_geo_city"),C.geo_dma=e.get("user_attr_kx_geo_dma")),e.size(e.get("config_segments"))&&(C.rtsegs=a("segments").realtime()),T=function(a,b){var c,d;for(c in b)f.call(b,c)&&(d=b[c],C[a+c]=d)},T("_kua_",j.user_attr()),T("_kpa_",j.page_attr()),T("",j.namespace("pixel_data")()),z=null!=(F=c.performance)?F.navigation:void 0,O=null!=(G=c.performance)?G.timing:void 0,!z||!O||u.ff&&u.version<9||(n=function(a,b){var c;return null==b&&(b=void 0),null==b&&(b=a+"End",a+="Start"),c=O[a]&&O[b]&&O[b]-O[a],null==c||0>c||c>3e4?-1:c},e.extend(C,{t_navigation_type:z.type,t_dns:n("domainLookup"),t_tcp:n("connect"),t_http_request:n("request"),t_http_response:n("response"),t_content_ready:n("navigationStart","domInteractive"),t_window_load:n("navigationStart","loadEventStart"),t_redirect:n("redirect")})),M=a("scrape"),Q=e.happened("user_data_response"),A=a("ns"),s=A.isDefault?d:d[A.name]||{},e.extend(C,{interchange_ran:s.hasOwnProperty("user"),store_user:s.user,store_segs:s.segments,dart_user:M.dart("u"),dart_segs:M.dart("ksgmnt")||M.dart("ksg"),userdata_was_requested:!!e.happened("user_data_request"),userdata_did_respond:!!Q,store_user_after:v.get("user"),store_segs_after:v.get("segs")}),Q&&e.extend(C,{userdata_user:[Q.kuid,Q.kuid_long],userdata_segs:[].concat(function(){var a,b;a=Q.segments,b=[];for(m in a)f.call(a,m)&&(S=a[m],b.push(S));return b}())}),B=v.get("org_user_id"),null!=B&&""!==B?e.extend(C,{_kuid:B}):i.get("params.target_fingerprint",!1)&&!l.hasThirdPartyCookies()&&e.extend(C,{_kuid:e.get("fp_id")}),i.get("params.no_pii",!1)?e.extend(C,{browser_bucket:u.browser,browser_version:u.version}):i.get("params.fingerprint",!1)&&(q=e.get("fp"),r=e.get("fp_id"),e.extend(C,{kfuid:r,kxfp:q})),H={user:"_kua_",page:"_kpa_"};for(P in H){D=H[P],I=j[P+"_attr"]();for(x in I)R=I[x],C[D+x]=R}try{L=c.sessionStorage}catch(p){o=p,L=null}if(L)try{C.sview=L.krux_views=+(L.krux_views||0)+1}catch(U){}for(J=e.get("tags"),t=w=0,y=J.length;y>w;t=++w)N=J[t],(null!=(K=N.time)?K.end:void 0)&&(C["kplt"+t]=N.id,T("tag"+N.id+"_timing",{duration:N.time.duration}));return g(/tag.*_timing/i,function(){return!1}),k=a("http-jsonp").Request.all,C.jsonp_requests=function(){var a,b,c;for(c=[],a=0,b=k.length;b>a;a++)E=k[a],c.push([E.url,E.time.end-E.time.start]);return c}(),C},t=b.sendOnce=e.once(r),b.init=function(){e.onOnce("report",function(){var a;a=e.partial(t,"report"),e.happened("user_data_fetch_scheduled")?(e.onOnce("user_data_response",function(){e.defer(a)}),c.setTimeout(function(){t("user_data_timeout")},300)):a()}),e.onOnce("dom:beforeunload",function(){t("dom:beforeunload")}),e.onOnce("dom:unload",function(){t("dom:unload")}),e.on("navigation",function(a){var b;b={source:"smarttag",type:"navigation",_kpid:e.get("pubid"),_kcp_s:e.get("site"),_kcp_sc:a.section,_kcp_ssc:a.subsection},s(b)}),a("test").module("pixel",function(a){a("pixel",e.happened("pixel"))})}}),a("privacy",function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;return g=a("util"),h=a("config"),i=a("feature"),l=a("http"),s=a("routes"),t=a("sniff"),u=a("store"),k=a("krux-uid").fromShort,a("events"),a("data"),c="optout:",f=6*g.MONTHS,d={ATTEMPT_CHANGE:c+"attemptChange",CHANGE:c+"change",ERROR:c+"error",REQUEST:c+"request",RESPONSE:c+"response",USER_UPDATE:"user:update"},e=b.OPTOUT_ALLOWED_KEYS=[/^tag\d*\.day$/,"optout"],b.Events=g.clone(d),o=function(a){return g.extend({code:"success",type:"no_change",time:new Date},a)},q=!1,j=function(a){g.fire(d.REQUEST),l.jsonp({callback:"kxjsonp_optOutCheck",done:a,fail:g.partial(g.fire,d.ERROR),url:h().get("services.is_optout")})},r=function(a){var b;g.fire(d.ATTEMPT_CHANGE),b=g.partial(g.fire,d.CHANGE),i.hasThirdPartyCookies()?l.jsonp({callback:"kxjsonp_optOutChange",done:b,fail:g.partial(g.fire,d.ERROR),url:h().get("services.set_opt"+(a?"out":"in"))}):b(o({type:"optout_change"}))},p=b.optOut=function(a,b){null==a&&(a=!0),null==b&&(b=!1),a?(n()||r(a),u.allowOnly.apply(u,e),u.clear(),b&&!i.hasThirdPartyCookies()||u.set("optout","true")):(n()&&r(a),u.allowAll(),u.remove("optout")),q=a,h().set("dnt",q)},w=function(){return"true"===("function"==typeof u.get?u.get("optout"):void 0)},m=b.isDnt=function(){var a;return t.ie&&t.version>=10?!1:(a=g.deref("doNotTrack"),null==a&&(a=g.deref("navigator.doNotTrack")),/(?:yes|1)/i.test(a))},n=b.isOptOut=function(){return Boolean(q||h().get("dnt")||w()||m())},v=function(a){var b,c;null==a&&(a=g.get("user")||("function"==typeof u.get?u.get("kuid"):void 0)),c="function"==typeof u.get?u.get("org_user_id"):void 0,q||null==a&&!c||(g.set("user",c||a),b=function(){switch(!1){case""===c:return c;case!h().get("params.dfp_premium",!1):return k(a).toLongId();default:return a}}(),"function"==typeof u.set&&u.set("user",b,f),"function"==typeof u.set&&u.set("kuid",a,f),g.fire(d.USER_UPDATE,{kuid:b,"short":a,"long":k(a).toLongId()}))},b.handler=function(a){var b;g.fire(d.RESPONSE,a),b=a._kuid_||a.kuid,a.optout||/^(?:OPTOUT|DNT)$/i.test(a._kuid_||"")?p():null!=a&&null==(null!=a?a.optout:void 0)&&null==b||p(!1),v(b)},g.extend(function(){var a;g.onOnce("dom:load",function(){return j(b.handler)}),a=function(){m()?p(!0,!0):n()&&p(),g.off(u.READY_EVENT,a)},g.onOnce(u.READY_EVENT,a),s.simple("optout",function(a,b){var c,e,f;return null==b&&(b=g.noop),null==a?n():a===n()?void b(null,o()):(e=function(){g.off(d.CHANGE,f),g.off(d.ERROR,c)},f=function(a){return b(null,a),e()},c=function(a){return b(new Error(a.message),a),e()},g.on(d.CHANGE,f),g.on(d.ERROR,c),void p(a))})},b,{Events:d,fetch:function(a){return null==a&&(a=g.noop),j(function(c){return b.handler(c),a(c)})},storeKuid:v,USER_ID_TTL:f})});var d=function(a,b){return function(){return a.apply(b,arguments)}};a("proxy/broker",function(a){var b,c;return c=a("x-frame"),b=function(){function a(a,b,c){this.window=a,this.targetDomain=b,null==c&&(c=!0),this._runQueue=d(this._runQueue,this),this._listen=d(this._listen,this),this.stop=d(this.stop,this),this.publish=d(this.publish,this),this.subscribe=d(this.subscribe,this),this.run=d(this.run,this),this.topics={},this.acked=!c,this.queue=[],this.handle=null}return a.prototype.run=function(){return null==this.handle,null==this.handle&&(this.handle=c.listen(this._listen,{strict:!1})),this},a.prototype.subscribe=function(a,b){var c,d,e;return e=null!=(c=this.topics)[a]?c[a]:c[a]=[],d=e.push(b)-1,{remove:function(){e.splice(d,1)}}},a.prototype.publish=function(a,b){var d;return d={topic:a,message:b},this.acked?c.send(this.window,d,this.targetDomain):this.queue.push(d),this},a.prototype.stop=function(){var a;return null!=(a=this.handle)&&a.remove(),this},a.prototype._listen=function(a){var b,c,d,e,f,g,h;if(f=a.data,h=f.topic,e=f.message,null!=h&&h in this.topics)for("ack"===e&&(this.acked=!0,this._runQueue()),g=this.topics[h],c=0,d=g.length;d>c;c++)(b=g[c])(h,e)},a.prototype._runQueue=function(){var a,b,c,d,e,f;for(f=this.queue,this.queue=[],a=0,b=f.length;b>a;a++)d=f[a],e=d.topic,c=d.message,this.publish(e,c);return this},a}()});var d=function(a,b){return function(){return a.apply(b,arguments)}};a("proxy/client",function(a){var b,c,e;return c=a("util"),e=a("uuid"),b=function(){function a(a,b){this.uid=a,this.broker=b,this._handleSuccess=d(this._handleSuccess,this),this._publish=d(this._publish,this),this.remove=d(this.remove,this),this.count=d(this.count,this),this.clear=d(this.clear,this),this.set=d(this.set,this),this.get=d(this.get,this),this.stop=d(this.stop,this),this.run=d(this.run,this),this.inFlight={}}return a.prototype.run=function(){return this.broker.run(),this.handle=this.broker.subscribe(this.uid,this._handleSuccess),this},a.prototype.stop=function(){var a;return null!=(a=this.handle)&&a.remove(),this},a.prototype.get=function(a,b){return this._publish({action:"get",key:a},b)},a.prototype.set=function(a,b,c){return this._publish({action:"set",key:a,value:b},c)},a.prototype.clear=function(a){return this._publish({action:"clear"},a)},a.prototype.count=function(a,b,c){return this._publish({action:"count",key:a,delta:b},c)},a.prototype.remove=function(a,b){return this._publish({action:"remove",key:a},b)},a.prototype._publish=function(a,b){var d;return null==b&&(b=c.noop),d=e(),a.uid=d,this.broker.publish(this.uid,a),this.inFlight[d]=b,this},a.prototype._handleSuccess=function(a,b){var c,d;d=b.uid,"function"==typeof(c=this.inFlight)[d]&&c[d](a,b),delete this.inFlight[d]},a}()});var d=function(a,b){return function(){return a.apply(b,arguments)}},g=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};a("proxy/cookie-cutter",function(a){var b,c;return c=a("util").MINUTES,b=function(){function a(a){this.store=a,this._trim=d(this._trim,this),this.isOverSize=d(this.isOverSize,this),this.run=d(this.run,this)}var b,e,f;return e=["_kuid_"],f=1e3*c,b=1e3,a.prototype.run=function(){return this._trim(),this.handle=setInterval(this._trim,f),this},a.prototype.stop=function(){return clearInterval(this.handle),this},a.prototype.isOverSize=function(){return this.store.size()>b},a.prototype._trim=function(){try{this.isOverSize()&&this.store.until(function(a){return function(b,c){return g.call(e,c)>=0?!1:(a.store.remove(c,{domain:".krxd.net"}),!a.isOverSize())}}(this))}catch(a){}},a}()}),a("proxy/deliver",function(a){var b,c,d,e,f;return b=a("util"),d=a("config"),a("events"),f=function(){return"kx-proxy-"+d().get("confid")},e=!1,c=[],b.extend(function(d,g){var h,i,j,k,l,m,n,o;if(n=a("dom"),h=n.IFrame,i=n.byId,c.push(g),m=i(f()),null!=m||e){if(null!=m){for(k=0,l=c.length;l>k;k++)(j=c[k])(null!=(o=m.contentWindow)?o:m);c=[]}}else e=!0,b.onOnce("dom:ready",function(){return new h({onload:function(){var a,b,d,e,g;for(e=i(f()),b=0,d=c.length;d>b;b++)(a=c[b])(null!=(g=e.contentWindow)?g:e);return c=[]},attr:{id:f(),src:d,style:"display: none; visibility: hidden; height: 0; width: 0;"}})})},{getNode:function(){return a("dom").byId(f())},id:f})}),a("proxy/href",function(a){var b,c,d,e,f,g,h,i,j;return c=a("util"),d=a("config"),a("underscore").templateSettings={evaluate:/\{%([\s\S]+?)%\}/g,interpolate:/\{\{([\s\S]+?)\}\}/g,escape:/\{%-([\s\S]+?)%\}/g},b=window,g=b.location,h="http:"===g.protocol?"http:":"https:",e=function(a){return a.replace(/(\/\/[^\/]*)\/.*$/,"$1")},f=function(a){return a.replace(/\/*$/,"")},j=function(a){return 0===a.indexOf("http")?a:""+h+a},i=function(a,b){return"="===b.slice(-1)?""+b+a:c.template(b,{confid:a})},function(){var a,b,k,l,m;return a=d(),b=a.get("confid",""),k=i(b,f(j(a.get("services.config","//cdn.krxd.net/controltag/{{ confid }}.js")))),m=f(j(a.get("services.proxy","//cdn.krxd.net/partnerjs/xdi"))),l=h+"//"+g.hostname+(""===g.port?"":":"+g.port),{childTarget:decodeURIComponent(c.param("target")||""),parentTarget:e(m),iframe:m+"/proxy.c8213f64e976c8ed7595d8bc05a66dd4.html#!kxsrc="+encodeURIComponent(k)+"&kxtarget="+encodeURIComponent(l)}}}),a("proxy",function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o;return i=a("config"),j=a("proxy/deliver"),m=a("feature"),n=a("proxy/href"),o=a("store"),b=a("proxy/broker"),c=a("proxy/client"),d=a("proxy/cookie-cutter"),e=a("proxy/remote-store"),f=a("proxy/server"),g=null,h=[],k=!1,l=function(a){var b,c,d,e;for(c=h,h=[],d=0,e=c.length;e>d;d++)(b=c[d])(null,a)},{client:function(a){var d,e,f,o,p;if(!m.hasLocalStorage()||!m.hasThirdPartyCookies())return void a(new Error("localStorage not usable"),g);if(h.push(a),p=n(),f=p.iframe,o=p.parentTarget,null!=g)l(g);else{if(k)return;if(null!=o){k=!0;try{j(f,function(a){return k=!1,l(g=new c(i().get("publisher.uuid"),new b(a,o,!0)).run())})}catch(e){d=e,a(d,g)}}else a(new Error("[proxy/index] unable to configure client, unusable proxyTarget found in proxy/href"))}},server:function(a){var c,g,h;o.init(),o.prefix="",g=i(a),g.set(""),h=g.get("publisher.uuid"),c=new b(window.parent,n().childTarget,!1),new f(h,c,new e(h,o)).run(),new d(o.cookie).run(),setTimeout(function(){return c.publish(h,"ack")},10)}}});var d=function(a,b){return function(){return a.apply(b,arguments)}};a("proxy/remote-store",function(a){var b,c,e,f,g,h,i,j,k,l,m;return c=window,i=a("util"),g=i.isNaN,b=i.DAYS,f=a("dom").d2on,j=a("json"),m=j.stringify,h=j.parse,k=a("sha1"),l=a("store"),e=function(){function a(a,b,c){var e;this.key=a,this.store=b,this.cookies=null!=c?c:!1,this._read=d(this._read,this),this._persist=d(this._persist,this),this._listen=d(this._listen,this),this.set=d(this.set,this),this.remove=d(this.remove,this),this.count=d(this.count,this),this.clear=d(this.clear,this),this.get=d(this.get,this),this.run=d(this.run,this),this.checksum="",this.cache=null!=(e=this._read())?e:{}}var e;return e=3*b,a.prototype.run=function(){return this.cookies||f(c,"storage",this._listen),this},a.prototype.get=function(a){var b;return null!=(b=this.cache[a])?b:""},a.prototype.clear=function(){return this.cache={},this._persist()},a.prototype.count=function(a,b){var c;return null==b&&(b=1),c=Number(this.get(a)),(null==c||g(c))&&(c=0),this.set(a,c+b),this.get(a)},a.prototype.remove=function(a){return delete this.cache[a],this._persist()},a.prototype.set=function(a,b){return this.cache[a]=String(b),this._persist()},a.prototype._listen=function(a){var b;b=a.key,b===this.key&&this.checksum!==k(this.store.get(this.key))&&(this.cache=this._read())},a.prototype._persist=function(){return this.store.set(this.key,m(this.cache),e),this},a.prototype._read=function(){var a;return a=this.store.get(this.key),this.checksum=k(a),h(a)},a}()});var d=function(a,b){return function(){return a.apply(b,arguments)}},g=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};a("proxy/server",function(){var a;return a=function(){function a(a,b,c){this.uid=a,this.broker=b,this.store=c,this._handleMessage=d(this._handleMessage,this),this.set=d(this.set,this),this.remove=d(this.remove,this),this.get=d(this.get,this),this.count=d(this.count,this),this.clear=d(this.clear,this),this.stop=d(this.stop,this),this.run=d(this.run,this)}var b;return b=["clear","count","get","remove","set"],a.prototype.run=function(){return this.store.run(),this.broker.run(),this.handle=this.broker.subscribe(this.uid,this._handleMessage),this},a.prototype.stop=function(){return this.handle.remove(),this},a.prototype.clear=function(){this.store.clear()},a.prototype.count=function(a){var b,c;return c=a.key,b=a.delta,this.store.count(c,b)},a.prototype.get=function(a){var b;return b=a.key,this.store.get(b)},a.prototype.remove=function(a){var b;b=a.key,this.store.remove(b)},a.prototype.set=function(a){var b,c;b=a.key,c=a.value,this.store.set(b,c)},a.prototype._handleMessage=function(a,c){var d,e,f,h;d=c.action,h=c.uid,g.call(b,d)>=0&&(f=this[d](c),e={uid:h},null!=f&&(e.value=f),this.broker.publish(a,e))},a}()}),a("publisher",function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;return b=window,e=b.document,h=b.location,c=a("util"),d=a("config"),f=a("feature"),g=a("fingerprint"),i=a("privacy"),j=a("proxy"),k=a("data-rewrite").tag,l=a("store"),m=a("timing"),n=a("krux-uid"),function(o,p){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;if(m.start(),r=d(p),w=a("dom"),a("jslog"),v=a("data"),v.user_attr=v.namespace("user_attr"),v.page_attr=v.namespace("page_attr"),a("whistle")(function(a){return v.user_attr.set("kx_whistle",Number(a))}),C=a("routes"),a("scrape"),a("dataprovider"),a("events"),e.getElementById("kxinterchange")&&a("kxinterchange"),s=r.get("confid"),c.set("confid",s),c.set("domain",w.baseDomain(h.host)),c.set("schema_version",r.get("app.schema_version")),c.set("site",c.get("site")||r.get("site.name")||c.get("domain")),c.set("siteid",c.get("siteid")||r.get("site.id")),c.set("pubid",c.get("pubid")||r.get("publisher.uuid")),r.get("params.no_pii")&&(c.set("pixel_data__knopii",1),v.user_attr("kx_lang",null),v.user_attr("kx_tech_browser_language",null)),a("pixel").init(),a("test").init(),a("test-visualtags").init(),c.set("tags",r.get("tags")),c.set("url",b.location.href),c.set("config",r.toJSON()),c.set("version_bucket",r.get("params.control_tag_version")),c.set("max_segments",r.get("params.max_segments")),c.set("prioritized_segments",r.get("prioritized_segments")),v.namespace("url",r.get("services")),v.namespace("config_param",r.get("params")),D=l.init(),i(),a("geo")(),w.safeMode())return b.console,c.onOnce("dom:load",c.bind(c.fireOnce,null,"report")),void m.end();if(r.get("params.store_realtime_segments",!1)&&j.client(function(a,b){if(null==a)try{return b.set("last_run",c.now())}catch(d){}}),r.get("params.fingerprint")&&!i.isOptOut()&&g(l),z=null,t=r.get("params.user_id_cookie",null),null!=t)for(B=t.split(","),x=0,y=B.length;y>x;x++)A=B[x],null==z&&(u=l.cookie.get(A,null),(null!=u?u.length:void 0)>0&&(z=A+"_"+u));G=f.hasThirdPartyCookies(),null==z||G?D.remove("org_user_id"):(D.set("org_user_id",z),c.set("user",z)),null==z&&r.get("params.first_party_uid")&&!G&&(H=D.get("kuid")||n().toShortId(),c.set("user",H),i.storeKuid()),F=function(){var a,b,d,e;for(d=c.get("tags")||[],e=[],a=0,b=d.length;b>a;a++)E=d[a],e.push(k(E));return e}(),c.set("tags",F),c.set("config_segments",r.get("realtime_segments")),c.onOnceAll("dom:load tag:all_done whistle",function(){c.fireOnce("report")}),q=a("adm-events"),q.parseConfig(r.get("realtime_segments",[])),q.check3rdParty(),a("segments"),a("stats"),a("social"),C.api(),r.get("context_terms")&&c.onOnce("dom:load",function(){a("context-terms").process(r.get("context_terms"))}),a("tag").init(),r.get("params.recommend")&&a("recommend"),m.end()}});var d=function(a,b){return function(){return a.apply(b,arguments)}},e=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},f={}.hasOwnProperty;a("recommend",function(a){var b,c,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha;y=a("util"),H=a("dom"),ea=a("store"),E=a("config")(),$=a("routes"),P=a("hogan-3"),ca=a("sizzle"),ba=a("sha1"),Q=a("http"),T=a("json"),ga=a("uuid"),K=a("geo"),fa=a("tag-delivery"),a("data"),k=window,h=k.document,n=k.location,s=n.protocol+"//",l=n.host,r=n.pathname,v=7*y.DAYS,u=5e3,p="1.0",c="rec",i="recfc",o=100,t=5,f=s+"apiservices.krxd.net/click_tracker/track",G={test:0,links:5,template:null,freqcap:10,domains:l,filter:"",fields:"",algorithms:[],objectives:{},tracking:{},shuffle:!0,ranking:"sort",content_type:"",click_event:"",impression_event:"",ads:0,postprocess:null},W=y.get("pubid"),_=ea.get("allsegs"),F=""+s+l+r,V=y.now(),B={},j=function(){function a(a){var b;this.cap=a,this.table=function(){var a;try{return T.parse(ea.get(i,{}))}catch(a){return b=a,{}}}()}return a.prototype.get=function(a){return a in this.table?this.table[a]:[0,0]},a.prototype.increment=function(a,b){this.table[a]=[b+1,V]},a.prototype.save=function(){var a,b,c,d,e,f,g;if(d=y.keys(this.table),d.length>o)for(a=function(){var a,b,d;a=this.table,d=[];for(c in a)b=a[c],y=b[0],g=b[1],d.push([c,g]);return d}.call(this),a.sort(function(a,b){return a[1]>b[1]?-1:a[1]<b[1]?1:0}),a=a.slice(0,+(d.length-o)+1||9e9),b=0,e=a.length;e>b;b++)f=a[b],c=f[0],y=f[1],delete this.table[c];ea.set(i,T.stringify(this.table))},a}(),q=function(){function a(a,b){this.cap=a,this.table=null!=b?b:{}}return a.prototype.get=function(a){return[0,0]},a.prototype.increment=function(a,b){},a.prototype.save=function(){},a}(),j.create=function(a){return a>0?new j(a):new q(a)},z=function(a){return B[a.name]=a},J=function(a){var b,c,d,e,f;for(e=a.algorithms,f=[],b=0,d=e.length;d>b;b++)c=e[b],B[c].enabled&&f.push(B[c]);return f},I=function(){return{entry:[]}},aa=function(a){return y.get("url_contentConnector")+a},C=function(a){var b,c;if(null==a)throw new Error("Content connector requires a template");if(c=H.byId(a),null==c)throw new Error("Could not find content connector template for '"+a+"'.");if(b=H.text(c),null==b)throw new Error("Could not get content connector template for '"+a+"'.");return P.compile(b)},M=function(a,b){var c,d,e,f;e=y.urlParams(a),a=a.split("?")[0];for(c in b)f=b[c],e[c]=f;return d=y.paramString(e),d.length>0?a+"?"+d:a},D=function(a,b){var c,d,e,f,g,h,i,k,l,m,n,o,p,q,r;for(o=b.algorithms,g=0,l=o.length;l>g;g++)i=o[g],i in a||(a[i]=B[i].defaultValue());for(f=j.create(b.freqcap),d={},q=(p=[]).concat.apply(p,function(){var c,d,e,f;for(e=b.algorithms,f=[],c=0,d=e.length;d>c;c++)i=e[c],f.push(a[i].entry);return f}()),h=0,m=q.length;m>h;h++)e=q[h],e.hash=ba(e.url),e.hash in d?d[e.hash].rank+=1:(e.rank=1,r=f.get(e.hash),e.count=r[0],e.lastShown=r[1],d[e.hash]=e);switch(d=function(){var a;a=[];for(c in d)e=d[c],e.url!==F&&(b.freqcap<1||e.count<=b.freqcap)&&a.push(e);return a}(),b.ranking){case"sort":d.sort(function(a,b){return a.rank>b.rank?-1:a.rank<b.rank?1:0});break;case"shuffle":y.shuffle(d)}if(d=d.slice(0,+(b.links-1)+1||9e9),b.shuffle&&y.shuffle(d),b.freqcap>0){for(k=0,n=d.length;n>k;k++)e=d[k],f.increment(e.hash,e.count+1);f.save()}return{entry:d}},L=function(a){var b;return(b=/^(before|after|inside|replace):(.+)$/.exec(a))?[b[1],b[2]]:["inside",a]},R=function(a,b,c){var d;switch(a){case"inside":b.innerHTML=c;break;default:switch(d=h.createElement("div"),d.innerHTML=c,a){case"before":H.before(b,d);break;case"after":H.after(b,d);break;default:H.replace(b,d)}}},Z=function(a,b){var c,d,e,g,h,i,j,k,l,m,n;for(b.tracking.kx_cc=1,b.click_event&&(b.tracking.kx_event_uid=b.click_event),b.tracking.kx_event_lnk=ga(),b.tracking.kx_tz=(new Date).getTimezoneOffset(),b.tracking.kx_co=K.get("country"),b.tracking.kx_st=K.get("region"),b.tracking.kx_met=K.get("dma"),b.tracking.kx_pcode=K.get("zip"),b.tracking.kx_seg=_,
b.tracking.kx_site_id=y.get("siteid"),b.tracking.kx_tag_id=null!=(j=fa.getTagContext("tag"))?j.id:void 0,c={},k=a.entry,e=g=0,i=k.length;i>g;e=++g)d=k[e],c["url"+(e+1)]=d.url,b.tracking.clk=d.url,b.tracking.kx_pub_id=W,d.url=M(f,b.tracking),delete b.tracking.clk,delete b.tracking.kx_pub_id,null!=b.postprocess&&b.postprocess(d);if(H.addStylesheet(b.stylesheet),l=C(b.template).render(a),m=ca.find(b.selector)[0],null==m)throw new Error("Could not find target element for '"+b.selector+"'");if(R(b.insertionPoint,m,l),b.impression_event){for(h in c)n=c[h],b.tracking[h]=n;delete b.tracking.kx_event_uid,b.tracking.event_type="ccvw",$.call("admEvent",b.impression_event,b.tracking)}},N=function(a,b,c,d){var e,f,g,h,i,j;for(f in a)j=a[f],f in b||(b[f]=j);for(h=d.algorithms,e=0,g=h.length;g>e;e++)if(f=h[e],!(f in b))return;null!=c&&k.clearTimeout(c),i=D(b,d),i.entry.length>0&&Z(i,d)},O=function(a,b){var c,d,e,f,g;for(f={},g=b.algorithms,c=0,e=g.length;e>c;c++)d=g[c],d in a||(f[d]=B[d].defaultValue());return N(f,a,null,b)},da=function(a,b){return k.setTimeout(function(){return O(a,b)},u)},ha=function(a,b){var c,d,e,f,g;if(!(1<=(e=b.links)&&10>=e))throw new Error("Content connector links must be between 1 and 10");if(null==b.template||""===b.template)throw new Error("Content connector requires a template to be specified in options");for(d in G)g=G[d],d in b||(b[d]=g);for(d in b)g=b[d],y.isArray(g)&&(b[d]=g.join(","));return y.isObject(b.objectives)&&(b.objectives=y.paramString(b.objectives,";",",",String)),y.isString(b.tracking)&&(b.tracking=y.parseParams(b.tracking)),b.algorithms=function(){var a,c,e,f,g;for(e=b.algorithms.split(","),g=[],a=0,c=e.length;c>a;a++)d=e[a],(null!=(f=B[d])?f.enabled:void 0)&&g.push(d);return g}(),0===b.algorithms.length&&(b.algorithms=function(){var a;a=[];for(d in B)c=B[d],c.enabled&&a.push(d);return a}()),f=L(a||b.selector),b.insertionPoint=f[0],b.selector=f[1],b},b=function(){function a(a,b){this.name=a,this.enabled=null!=b?b:!0,this.fetch=d(this.fetch,this)}return a.prototype.defaultValue=function(){return I()},a.prototype.execute=function(a,b,c){},a.prototype.afterLoad=function(a){},a.prototype.fetch=function(a,b,c,d){var e;e=function(d){return function(){var e;return e={},e[d.name]=d.defaultValue(),N(e,a,b,c)}}(this),this.enabled?Q.jsonp({url:aa(this.name),callback:"kxjsonp_contentConnector"+this.name,data:d,done:function(d){return function(f){var g;return f.entry.length>0?(d.afterLoad(f),g={},g[d.name]=f,N(g,a,b,c)):e()}}(this),fail:e}):e()},a}(),x=function(a){function b(){this.execute=d(this.execute,this),b.__super__.constructor.call(this,"user")}return e(b,a),b.prototype.defaultValue=function(){var a,b;return b=function(){var b;try{return T.parse(ea.get(c,null),I())}catch(b){return a=b,null}}()},b.prototype.afterLoad=function(a){ea.set(c,T.stringify(a),v)},b.prototype.execute=function(a,b,c){this.fetch(a,b,c,{pubid:W,lang:k.navigator.language,filter:c.filter,ct:c.content_type,dom:c.domains,fields:c.fields,obj:c.objectives,seg:_,nv:p,ni:c.links*t})},b}(b),m=function(a){function b(){this.execute=d(this.execute,this),b.__super__.constructor.call(this,"item")}return e(b,a),b.prototype.execute=function(a,b,c){this.fetch(a,b,c,{pubid:W,lang:k.navigator.language,filter:c.filter,ct:c.content_type,dom:c.domains,fields:c.fields,obj:c.objectives,url:F,nv:p,ni:c.links*t})},b}(b),g=function(a){function b(){this.execute=d(this.execute,this),b.__super__.constructor.call(this,"content")}return e(b,a),b.prototype.execute=function(a,b,c){this.fetch(a,b,c,{pubid:W,lang:k.navigator.language,filter:c.filter,ct:c.content_type,dom:c.domains,fields:c.fields,obj:c.objectives,url:F,nv:p,ni:c.links*t})},b}(b),w=function(b){function c(){this.execute=d(this.execute,this),c.__super__.constructor.call(this,"ad",G.ads>0),this.enabled&&(this.flashVersion=a("flash").version())}return e(c,b),c.prototype.execute=function(a,b,c){this.fetch(a,b,c,{allimps:1,test:c.test,pubid:W,site_id:y.get("siteid"),url:F,cat:c.cat,search:c.search,utc:(new Date).getTimezoneOffset(),lang:k.navigator.language,fv:this.flashVersion.major+"."+this.flashVersion.minor,h:k.screen.height,w:k.screen.width,co:K.get("country"),st:K.get("region"),met:K.get("dma"),pcode:K.get("zip"),seg:_,nv:p,ni:c.ads,filter:c.filter,ct:c.content_type,dom:c.domains,fields:c.fields})},c}(b),X=function(a,b){var c,d,e,f,g,h;if(null==b&&(b={}),!E.get("params.recommend"))throw new Error("Content connector is not enabled for this account");for(b=y.isString(a)?ha(a,b):ha(null,a),d={},h=da(d,b),g=J(b),e=0,f=g.length;f>e;e++)c=g[e],c.execute(d,h,b)},Y=[new x,new m,new g,new w];for(S=0,U=Y.length;U>S;S++)A=Y[S],z(A);return $.simple("recommend",X),{recommend:X,algorithms:B,FrequencyTable:j,addAlgorithm:z,enabledAlgorithms:J,emptyResponse:I,serviceUrl:aa,compileTemplate:C,getUrlWithTracking:M,computeFinalRecommendations:D,getInsertionPointAndSelector:L,insertRenderedContent:R,renderResponse:Z,handleResponse:N,handleTimeout:O,validateOptions:ha,Algorithm:b,UserAlgorithm:x,ItemAlgorithm:m,ContentAlgorithm:g,SponsoredAlgorithm:w}}),a("rollout",function(a){var b,c,d;return c=a("util"),d=a("store"),b="ro_",function(a,e,f){var g,h,i,j;return null==e&&(e=.001),null==f&&(f=6*c.MONTHS),g=""+b+a,i=c.param(a),h=null!=i?/1|true/.test(i):void 0,j=c.rate(e)||"1"===d.get(g,"0"),null!=h&&(j=h),j?d.set(g,"1",f):d.remove(g),j}}),a("routes",function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o;d=window,e=b("util"),i=b("ns"),m=c.routes=[],j=c.q=d.Krux&&d.Krux.q||[],h=c.getHandler=function(a){var b,c,d;for(b=0,c=m.length;c>b;b++)if(d=m[b],d[0].test(a))return d},g=c.call=function(a){var c,d,f;return c=arguments,i.NS_RE.test(a)&&(d=i.router(a),null!=d)?e.size(c)>1?d.apply(d,e.tail(c)):d:e.isFunction(a)?a.call(null,b):(f=h(a))?f[1].apply(null,c):void j.push(e.toArray(c))},o=c.understands=function(a){return!!h(a)},l=c.replay=function(){var a,b,c,d;for(d=e.clone(j),j.length=0,b=0,c=d.length;c>b;b++)a=d[b],g.apply(null,a)},f=c.add=function(a,b){m.push([a,b]),l()},k=c.regexp=function(a,b){f(a,function(c){return b.apply(this,[c.match(a)].concat(e.rest(arguments)))})},n=c.simple=function(a,b){var c;c=new RegExp("^"+a+"$"),k(c,function(){return b.apply(null,e.rest(arguments))})},c.once=function(a,b){var d;d=function(){return m=c.routes=e.remove(m,d),b.apply(this,arguments)},n(a,d)},c.namespace=function(a,b){var c;c=new RegExp("^"+a+"\\.(.*)"),k(c,function(a){b[a[1]].apply(b,e.rest(arguments))})},c.api=function(){k(/^fire:(.+)/,function(a,b){return e.fire(a[1],b)}),k(/^on:(.+)/,function(a,b){return e.on(a[1],b)}),k(/^fireOnce:(.+)/,function(a,b){return e.fireOnce(a[1],b)}),k(/^onOnce:(.+)/,function(a,b){return e.onOnce(a[1],b)}),k(/^require:?(.*)/,function(a,c){return a[1]?b(a[1]):c?b(c):b}),n("define",a),n("JSON.stringify",d.JSON.stringify),n("log",e.log),n("page:load",function(a,c){var f,h,i,j,k,l;f=b("config")(),j=b("http"),k=b("pixel"),l=b("segments");try{e.set("url",String(d.location)),g("tag:reload",function(b){return a&&a(b),k.send("ajax",null!=c?c.pageView:void 0),f.get("params.store_realtime_segments",!1)&&l.putSegments(),j.clearRequestList()})}catch(i){h=i,a&&a(h)}})},n("understands",o)});var d=function(a,b){return function(){return a.apply(b,arguments)}},e=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},f={}.hasOwnProperty,g=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},c=[].slice;a("rules-network",function(a){var b,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I;return F=a("util"),G=a("expression"),H=function(a){return F.isString(a)?a.toLowerCase():a},I=function(a){var b;return b=G.parse(a),F.isArray(b)?b:[b]},t=function(){function a(){}return a.prototype.assert=function(){return!1},a.isMatch=function(){return!1},a}(),z=function(a){function b(a){this.id=a,this.assert=d(this.assert,this)}return e(b,a),b.prototype.assert=function(a){return a.add(this.id)},b}(t),b=function(a){function b(a,c,d){var e,f;this.id=a,this.operands=function(){var a,b,c;for(c=[],a=0,b=d.length;b>a;a++)e=d[a],c.push(H(e));return c}(),f=b.parseDelimiter(c),this.key=f[0],this.delimiter=f[1],this.productions=[]}return e(b,a),b.prototype.assert=function(a,b){var c,d,e,f,g,h;if(h=function(){switch(!1){case!F.isString(b):return b.split(this.delimiter);case!F.isArray(b):return b;case null==b:return[b];default:return[]}}.call(this),g=this._assert(a,function(){var a,c,d;for(d=[],a=0,c=h.length;c>a;a++)b=h[a],d.push(H(b));return d}()))for(a.assert(this.id),f=this.productions,c=0,d=f.length;d>c;c++)e=f[c],e.assert(a);return g},b.prototype._assert=function(){return!1},b.parseDelimiter=function(a){var b;return b=a.length,":"===a[b-2]?[a.slice(0,b-2),a[b-1]]:[a,","]},b}(t),p=function(a){function b(){return this._assert=d(this._assert,this),b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype._assert=function(a,b){var c,d,e;for(c=0,d=b.length;d>c;c++)if(e=b[c],g.call(this.operands,e)>=0)return!0;return!1},b.isMatch=function(a){return"intersects"===a},b}(b),w=function(a){function b(){return this._assert=d(this._assert,this),b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype._assert=function(){return!b.__super__._assert.apply(this,arguments)},b.isMatch=function(a){return"notIntersects"===a},b}(p),j=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.isMatch=function(a){return"contains"===a},b}(p),u=function(a){function b(){return this._assert=d(this._assert,this),b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype._assert=function(){return!b.__super__._assert.apply(this,arguments)},b.isMatch=function(a){return"notContains"===a},b}(j),C=function(a){function b(){return this._assert=d(this._assert,this),b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype._assert=function(a,b){var c,d,e,f;for(f=this.operands,c=0,d=f.length;d>c;c++)if(e=f[c],0===b.indexOf(e))return!0;return!1},b.isMatch=function(a){return"endsWith"===a},b}(b),k=function(a){function b(){return this._assert=d(this._assert,this),b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype._assert=function(a,b){var c,d,e,f;for(f=this.operands,c=0,d=f.length;d>c;c++)if(e=f[c],b.length===e.length+b.indexOf(e))return!0;return!1},b.isMatch=function(a){return"endsWith"===a},b}(b),s=function(a){function b(){return this._assert=d(this._assert,this),b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype._assert=function(a,b){var c,d,e,f,g,h,i;for(h=this.operands,c=0,e=h.length;e>c;c++)for(g=h[c],d=0,f=b.length;f>d;d++)if(i=b[d],null!=i&&"function"==typeof i.match?i.match(g):void 0)return!0;return!1},b.isMatch=function(a){return"matches"===a},b}(b),x=function(a){function b(){return this._assert=d(this._assert,this),b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype._assert=function(){return!b.__super__._assert.apply(this,arguments)},b.isMatch=function(a){return"notMatches"===a},b}(s),m=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype._assert=function(a,b){var c,d,e;for(c=0,d=b.length;d>c;c++)if(e=b[c],e===!0)return!0;return!1},b.isMatch=function(a){return 0===("function"==typeof a.indexOf?a.indexOf("$event"):void 0)},b}(b),i=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype._assert=function(a,b){var c,d,e,f,g,h,i;for(h=this.operands,c=0,e=h.length;e>c;c++)for(g=h[c],d=0,f=b.length;f>d;d++)if(i=b[d],this.compare(i,g))return!0;return!1},b.prototype.compare=function(){return!1},b.isMatch=function(){return!1},b}(b),r=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.compare=function(a,b){return b>a},b.isMatch=function(a){return"<"===a},b}(i),o=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.compare=function(a,b){return a>b},b.isMatch=function(a){return">"===a},b}(i),q=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.compare=function(a,b){return b>=a},b.isMatch=function(a){return"<="===a},b}(i),n=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.compare=function(a,b){return a>=b},b.isMatch=function(a){return">="===a},b}(i),l=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.compare=function(a,b){return a===b},b.isMatch=function(a){return"=="===a||"equals"===a},b}(i),v=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.compare=function(a,b){return a!==b},b.isMatch=function(a){return"!="===a||"notEquals"===a},b}(i),h=function(a){function b(){var a,b,d,e,f,h;for(b=arguments[0],f=2<=arguments.length?c.call(arguments,1):[],this.id=b,this.operands=f,this.productions=[],h=this.operands,a=0,d=h.length;d>a;a++)e=h[a],g.call(e.productions,this)<0&&e.productions.push(this)}return e(b,a),b.prototype.assert=function(){return!1},b}(t),D=function(a){function b(a){this.id=a,this.productions=[]}return e(b,a),b.prototype.assert=function(){return!1},b.isMatch=function(){return!0},b}(t),f=function(a){function b(){return this.assert=d(this.assert,this),b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.assert=function(a){var b,c,d,e,f,g,h,i;for(h=this.operands,b=0,d=h.length;d>b;b++)if(f=h[b],1!==a.assertions[f.id])return!1;for(a.assert(this.id),i=this.productions,c=0,e=i.length;e>c;c++)g=i[c],g.assert(a);return!0},b.isMatch=function(a){return"and"===a},b}(h),y=function(a){function b(){return this.assert=d(this.assert,this),b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.assert=function(a){var b,c,d,e,f,g,h,i;for(h=this.operands,b=0,d=h.length;d>b;b++)if(f=h[b],1===a.assertions[f.id]){for(a.assert(this.id),i=this.productions,c=0,e=i.length;e>c;c++)g=i[c],g.assert(a);return!0}return!1},b.isMatch=function(a){return"or"===a},b}(h),E=function(){function a(a){this.ruleBase=a,this.set=d(this.set,this),this.assert=d(this.assert,this),this.results=d(this.results,this),this.add=d(this.add,this),this.assertions={},this.productions={}}return a.prototype.add=function(a){return this.productions[a]=1},a.prototype.results=function(){var a,b,c,d;b=this.productions,c=[];for(a in b)d=b[a],c.push(a);return c},a.prototype.assert=function(a){return this.assertions[a]=1},a.prototype.set=function(a,b){var c,d,e,f,g,h;if(c=this.ruleBase.alphaNodes,a in c){for(g=c[a],h=[],d=0,e=g.length;e>d;d++)f=g[d],h.push(f.assert(this,b));return h}},a}(),A=function(){function a(a){this.alphaNodes=a,this.open=d(this.open,this)}return a.prototype.open=function(){return new E(this)},a}(),B=function(){function a(){this.build=d(this.build,this),this.addNode=d(this.addNode,this),this.addBetaNode=d(this.addBetaNode,this),this.addAlphaNode=d(this.addAlphaNode,this),this.addRule=d(this.addRule,this)}return a.prototype.alphaTypes=[j,k,l,m,n,o,p,q,r,s,u,v,w,x,C],a.prototype.betaTypes=[f,y,D],a.prototype.alphaNodes={},a.prototype.nodes={},a.prototype.isAlphaNode=function(b){var c,d,e,f;for(e=a.prototype.alphaTypes,c=0,d=e.length;d>c;c++)if(f=e[c],f.isMatch(b))return!0;return!1},a.prototype.addRule=function(a){var b;return b=this.addNode(a.test),b.productions.push(new z(a.id))},a.prototype.addAlphaNode=function(b,c){var d,e,f,g,h,i,j,k,l,m,n;for(m=F.isArray(c)?c:[c,c,[]],l=m[0],h=m[1],k=m[2],n=a.prototype.alphaTypes,g=0,i=n.length;i>g;g++)if(d=n[g],d.isMatch(l)){e=new d(b,h,I(k)),(null!=(f=this.alphaNodes)[j=e.key]?f[j]:f[j]=[]).push(e);break}return this.nodes[b]=null!=e?e:new D(b,h,k)},a.prototype.addBetaNode=function(b,d){var e,f,g,h,i,j,k;for(h=d.slice(1),k=function(){var a,b,c;for(c=[],a=0,b=h.length;b>a;a++)j=h[a],c.push(this.addNode(j));return c}.call(this),i=a.prototype.betaTypes,f=0,g=i.length;g>f;f++)if(e=i[f],e.isMatch(d[0]))return this.nodes[b]=function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b);return Object(e)===e?e:d}(e,[b].concat(c.call(k)),function(){})},a.prototype.addNode=function(a){var b;switch(b=""+a,!1){case 2!==a.length:return this.addNode(a[1]);case!this.isAlphaNode(F.isArray(a)?a[0]:a):return b in this.nodes?this.nodes[b]:this.addAlphaNode(b,a);default:return b in this.nodes?this.nodes[b]:this.addBetaNode(b,a)}},a.prototype.build=function(){var a;return a=new A(this.alphaNodes),this.alphaNodes={},this.nodes={},a},a}()});var f={}.hasOwnProperty,g=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};a("scrape",function(a,b){var c,d,e,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;c=window,d=a("util"),j=a("data"),y=a("sizzle"),w=a("routes"),o=a("dom"),n=b.defaultExcludes=["sz","dcopt","ord","tile","pos","uri","click","ksgmnt","null","undefined"],e=b._dart=function(){var a,e,f,g,h,i,k,l,m,n,o,p,q,r,s,t,u,v,w,x;for(g=function(a){return y.find("script[src*="+k+"]",a).concat(y.find("iframe[src*="+k+"]",a))},k=".doubleclick.net",x={},f=[],f=f.concat(g(c.document)),i=y.find("iframe[src*=://"+c.location.hostname+"]").concat(y.find("iframe[src^=/]")),l=0,p=i.length;p>l;l++){h=i[l];try{a=h.contentWindow.document,f=f.concat(g(a))}catch(z){}}for(b.dartElements=f,m=0,q=f.length;q>m;m++){e=f[m],w=y.attr(e,"src"),r=w.match(/[^;]*;(.*)/),o=r&&r[1],t=d.parseKeyValues(o,";");for(n in t)s=t[n],u=x[n],u&&u!==s?(d.isArray(u)||(u=[u]),d.isArray(s)?u=u.concat(s):u.push(s),x[n]=d.uniq(u)):x[n]=s}return e=f[0],e&&(w=y.attr(f[0],"src"),r=w.match(/\.doubleclick\.net(\/[^;]*)/),v=r?r[1]:"",j.page_attr({dfpsite:v.split("/")[2],dfpzone:v.split("/")[3]})),x},i=void 0,h=function(a){var b,c,f,g,h,k,l;if(i&&!d.isEmpty(i)||(i=e()),b=new d.Set(a&&a._excludes||n),null==a)return i;if(d.isString(a))return i[a];h=[];for(c in a)k=a[c],g=j.namespace(c),d.isArray(k)?h.push(function(){var a,b,c;for(c=[],a=0,b=k.length;b>a;a++)f=k[a],i[f]?c.push(g(f,i[f])):c.push(void 0);return c}()):"*"===k?h.push(function(){var a;a=[];for(f in i)l=i[f],b[f]?a.push(void 0):a.push(g(f,l));return a}()):h.push(d.set(c,i[k]));return h},l=void 0,t=function(a,b){var c,d,e,f;if(e=""+a,!(null!=a&&e.length>0))return!1;for(c=0,d=b.length;d>c;c++)if(f=b[c],null!=e.match(f))return!1;return!0},m=function(a,b){var e,h,i,j,k,l,m,n,o,p,q,r,s,u;if(null==b&&(b={}),null==b.omitKeys&&(b.omitKeys=[]),null==b.omitValues&&(b.omitValues=[]),r={},null==a)return r;for(m=function(a,c){return t(a,b.omitKeys)&&t(c,b.omitValues)?r[a]?r[a].push(c):r[a]=[c]:void 0},p=d.isArray(a)?a.slice(0):[a],i=[c,document];p.length>0;){h=p.shift();for(k in h)if(f.call(h,k))if(u=h[k],d.isPrimitive(u))m(k,u);else if(d.isArray(u))for(j=0,l=u.length;l>j;j++)e=u[j],o={},o[k]=e,p.push(o);else if(d.isElement(u)){m(k,u);for(q in u)m(k+"."+q,u.getAttribute(q))}else if(d.isObject(u)&&g.call(i,u)<0){o={};for(n in u)s=u[n],o[k+"."+n]=s;i.push(u),p.push(o)}}return r},k=function(a){var b;return null==l&&(l=m(c.dataLayer)),(null!=(b=l[a])?b.length:void 0)<=1?l[a][0]:l[a]},b.clearDataLayerCache=function(){return l=void 0},p=function(a){var b,c,d,e,f,h,i,j,k,l,m;if(g.call(a,":")<0)return[];if(k=a.match(/^(.+):([^:]+)$/),e=k[0],m=k[1],i=k[2],h=y.find(m),!((null!=h?h.length:void 0)>0))return[];switch(!1){case"text"!==i&&"value"!==i:b=o[i],h=function(){var a,c,d;for(d=[],a=0,c=h.length;c>a;a++)f=h[a],d.push(b(f));return d}();break;case"@"!==i.charAt(0):j=i.substr(1),h=function(){var a,b,c;for(c=[],a=0,b=h.length;b>a;a++)f=h[a],c.push(o.attr(f,j));return c}();break;default:h=[]}for(l=[],c=0,d=h.length;d>c;c++)f=h[c],null!=f&&""!==f&&l.push(f);return l},s=b.ingestDataLayer=function(a,b){var c,e,g,h,i,j,l,n,o,p;if(null==b&&(b={}),null!=a){null==b.userKeys&&(b.userKeys=[]),null==b.omitKeys&&(b.omitKeys=[/gtm\./]),null==b.omitValues&&(b.omitValues=[/.*@.*(?:\..*)+/,/gtm\./]),h=function(a){return(""+a).replace(/([A-Z])/g,"_$1").replace(/^_/,"").replace(/__/g,"_").toLowerCase()},k=m(a,b),c={};for(i in k)f.call(k,i)&&(p=k[i],j=t(i,b.userKeys)?"page_attr_":"user_attr_",o=null!=(l=i.match(/[^.]*$/))?l[0]:void 0,e=b.useFullPath===!0?i:o,g=""+j+(b.caseSensitive?e:h(e)),c[g]=d.union(null!=(n=c[g])?n:[],p));return c}},w.simple("ingestDataLayer",function(a,b){var c;return null==b&&(b={}),c=s(a,b),d.set(c),c}),r=b.extensions={},q=b.extension=function(a,c){return r[a]=b[a]=c,w.simple("scrape."+a,c),c},v={dart:h,dataLayer:k,dom:function(a){return p(a)[0]},dom_multi:p,link_rel:function(a){return b.dom("link[rel="+a+"]:@href")},link_rev:function(a){return b.dom("link[rev="+a+"]:@href")},meta_name:function(a){return b.dom("meta[name="+a+"]:@content")},meta_property:function(a){return b.dom("meta[property="+a+"]:@content")},opengraph:function(a){return b.meta_property("og:"+a)},url_path:function(a){return b.location.pathname.split("/")[a]},url_param:function(a){var c;return c=b.location.href.match("\\b"+a+"(?:=|\\b)([^&#]*)"),c&&(decodeURIComponent(c[1])||!0)},url_hash:function(a){return[""].concat(String(c.location.hash).replace(/^(?:#|\/){0,}/,"").split("/"))[a]},url_host:function(a){return b.location.hostname.split(".").reverse()[a-1]},url_domain:function(a){return d.last(b.location.hostname.split("."),a).join(".")},cookie:function(a){var b;return b=c.document.cookie,b&&(b=b.match("\\b"+a+"=([^;]*)"))&&decodeURIComponent(b[1])},data:function(a){return d.get(a)},javascript:function(a){var b,e;try{return c.eval(a)}catch(e){b=e,d.fire("error",b)}},js_global:function(a){var b,d;try{for(d=c,b=a.split(".");d&&b[0];)d=d[b.shift()];return d}catch(e){}},onboard:function(b){var c;return c=b.toLowerCase().replace(/\s+/g,"").replace(/\+[^@]+@gmail/,"@gmail"),""!==c?a("sha1")(c):void 0}};for(u in v)z=v[u],q(u,z);b.location=c.location,x=b.scrape=function(a){var b,c,e,f,g;f={};for(e in a){c=a[e],b=void 0;for(u in c)if(null!=r[u]){b=u;break}if(null==b){d.fire("error",{message:"No extension found",scrape:a});break}g=r[b](c[b]),f[e]=g}return f},w.simple("scrape",function(a){var b;return b=x(a),d.set(b),b})});var f={}.hasOwnProperty,g=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};a("segments",function(a,b){var c,d,e,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O;if(k=a("util"),o=a("cache"),r=a("config")(),t=a("data"),A=a("json"),F=a("privacy"),G=a("proxy"),j=a("rules-network"),N=a("store"),e=3*k.DAYS,d=1*k.DAYS,h=1*k.MONTHS,c="_",i="rt",D=k.param("segs"),null!=D&&k.set("user_segments",D.split(",")),b.allRealtime=k.pluck(k.get("config_segments"),"id"),z=a("expression").eval,s=[],K=function(a,b){return null==b&&(b=d),N.set("rt_"+a,"1",b)},L=function(a){return k.set("user_segments",a),N.set("segs",a.join(","),e)},O=b.syncSegments=function(){var a;return a=k.now(),G.client(function(b,c){return null==b?c.get("segs",function(b,e){var g,h,i,j,k,l;l=e.value,j=A.parse(l,{});for(k in j)f.call(j,k)&&(g=j[k],Number(g)<=a?delete j[k]:K(k,Number(g)-a));for(h=0,i=s.length;i>h;h++)k=s[h],j[k]=a+1e3*d;return L(function(){var a;a=[];for(k in j)a.push(k);return a}().sort(function(a,b){switch(!1){case j[a]!==j[b]:return 0;case!(j[a]>j[b]):return-1;default:return 1}})),c.set("segs",A.stringify(j))}):void 0})},r.get("params.store_realtime_segments",!1)&&k.onOnce("pixel",O),M=function(a){return null==a&&(a=c),a===c?"segs":"segs_"+a},m=b.bucket=function(a){var b;return null==a&&(a=c),b=N.get(M(a)),b?b.split(","):[]},J=b.rete=k.once(function(){var a,b,c,d,e;for(a=new j,d=k.get("config_segments",[]),b=0,c=d.length;c>b;b++)e=d[b],a.addRule(e);return a.build().open()}),I=b.realtime=function(){var a,b,c,d,f,h,j,l,n,o,p;if(d=[],s.length=0,!F.isOptOut()){if(a=k.get("config_segments",[]),r.get("params.optimize_realtime_segments",!1))n=J().results(),d.push.apply(d,n),s.push.apply(s,n),N.forEach(function(b,e){return 0===e.indexOf("rt_")&&g.call(n,e)<0&&g.call(a,e)>=0?d.push(c):void 0});else for(b=0,h=a.length;h>b;b++)l=a[b],c=l.id,p=l.test,z(p)?(d.push(c),s.push(c)):N.get("rt_"+c)&&d.push(c);for(f=0,j=s.length;j>f;f++)c=s[f],K(c)}return o=r.get("params.store_realtime_segments",!1)?k.uniq(s.concat(m(i),d)):k.uniq(s.concat(d)),N.set(M(i),o,e),o},E=b.prioritizedSegments=function(){return k.get("prioritized_segments",[])},B=b.maxSegments=function(){return k.get("max_segments")||0},p=b.compute=function(){var a,c,d,f,h,i,j,l,n,o;if(j={user_segments:"segs",all_user_segments:"allsegs"},F.isOptOut())for(d in j)n=j[d],k.remove(d),N.remove(n);else if(!D){l=m(),o=k.difference(l,b.allRealtime),k.set("user_segments",o),c=k.uniq(I().concat(o));for(d in j)n=j[d],k.set(d,c),N.set(n,c.join(","),e);h=E(),f=B(),h.length>0&&f>0&&c.length>f&&(a=function(){var a,b,d;for(d=[],a=0,b=h.length;b>a;a++)i=h[a],g.call(c,i)>=0&&d.push(i);return d}().slice(0,f),k.set("user_segments",a),N.set("segs",a.join(","),e))}},y=b.handleUserDataResponse=function(a){var b,c,d,f,g,i;if(f=a.segments,d=a.kuid,g=a.technographics,F.storeKuid(d),null!=f)if(k.isArray(f))N.set(M(),f.join(","),e);else if(k.isObject(f))for(b in f)i=f[b],N.set(M(b),i.join(","),e);null!=g&&(N.set("tech",k.paramString(g),h),H()),r.get("params.fingerprint")&&(c=null!=a.kfuid?a.kfuid:k.get("fp"),N.set("fp_id",c,F.USER_ID_TTL),k.set("fp_id",c)),p(),k.fire("user_data_response",a)},H=b.readTechFromStore=function(){var a,b,c,d;if(c=N.get("tech")){if(1!==k.get("pixel_data__knopii")){b=k.parseKeyValues(c);for(a in b)d=b[a],k.set("user_attr_kx_tech_"+a,d)}return!0}return!1},v={url:k.get("url_userdata"),callback:"kxjsonp_userdata",done:y,data:{pub:k.get("pubid")}},C=N.get("org_user_id"),C&&(v.data._kuid=C),n=r.get("buckets"),(null!=n?n.length:void 0)>0&&(g.call(n,c)<0&&n.push(c),v.data.buckets=n.join(",")),r.get("params.fingerprint",!1)&&(w=k.get("fp"),v.data.kxfp=w,x=k.get("fp_id"),(null!=x?x.length:void 0)!==(null!=w?w.length:void 0)&&(v.data.kfuid=x)),H()||(v.data.technographics=1),u=b.fetch=function(){k.fireOnce("user_data_request"),a("http").jsonp(v)},!k.get("segWait")){switch(k.set("segWait",1,5*k.MINUTES),r.get("params.user_data_timing")){case"asap":u();break;case"ready":k.onOnce("dom:ready",u);break;default:k.onOnce("dom:load",u)}k.fire("user_data_fetch_scheduled")}N.get("segs"),r.get("params.store_realtime_segments",!1)&&O(),p(),l=N.get("allsegs")?N.get("allsegs").split(","):[],k.set("all_user_segments",l),r.get("params.optimize_realtime_segments",!1)?(k.on("data:change",function(a){var b,c,d;return b=a.key,d=a.value,c=J().results(),J().set("$"+b,d),k.difference(J().results(),c).length>0?p():void 0}),t.user_attr.change(p),t.page_attr.change(p)):(q=k.throttle(p,100),t.user_attr.change(q),t.page_attr.change(q)),t.namespace("event").change(p),a("test").module("segments",function(a){k.happened("user_data_fetch_scheduled")&&a("user_data_response",k.happened("user_data_response"))})});var d=function(a,b){return function(){return a.apply(b,arguments)}};a("sha1",function(a){var b,c,e,f,g,h;return f=a("crypto-util"),h=a("routes"),e=[],b={20:1518500249,40:1859775393,60:1894007588,80:899497514},c=function(){function a(a){this._message=null!=a?a:"",this._process=d(this._process,this),this._append=d(this._append,this),this.update=d(this.update,this),this.reset=d(this.reset,this),this.clone=d(this.clone,this),this.toString=d(this.toString,this),this.finalize=d(this.finalize,this),this.reset(),this._append(this._message)}return a.prototype._minBufferSize=0,a.prototype.finalize=function(){var a,b,c;return c=this._data,a=f.calculateSigBytesForWords(c),b=8*a,c[b>>>5]|=128<<24-b%32,c[(b+64>>>9<<4)+14]=Math.floor(b/f.MAX_WORD),c[(b+64>>>9<<4)+15]=b,this._process(),String(this)},a.prototype.toString=function(){return f.fromWordsToHex(this._hash)},a.prototype.clone=function(){var b;return b=new a(this._message),b._hash=this._hash.slice(0),b},a.prototype.reset=function(){return this._hash=this._getInitial(),this._data=[],this},a.prototype.update=function(a){return this._append(a),this},a.prototype._append=function(a){var b;return this._message+=a,b=f.fromUtf8ToWords(a),this._data.push.apply(this._data,b),this},a.prototype._process=function(){var a,b,c,d,e,g,h,i;if(i=this._data,c=i.length*f.BYTES_PER_WORD,a=16,b=4*a,d=c/b,e=d*a,h=void 0,e){for(g=0;e>g;)this._processBlock(i,g),g+=a;h=i.splice(0,e)}return h},a.prototype._processBlock=function(a,c){var d,f,g,h,i,j,k,l,m;for(d=this._hash,f=d[0],g=d[1],h=d[2],i=d[3],j=d[4],k=0;80>k;)16>k?e[k]=0|a[c+k]:(l=e[k-3]^e[k-8]^e[k-14]^e[k-16],e[k]=l<<1|l>>>31),m=(f<<5|f>>>27)+j+e[k],m+=20>k?(g&h|~g&i)+b[20]:40>k?(g^h^i)+b[40]:60>k?(g&h|g&i|h&i)-b[60]:(g^h^i)-b[80],j=i,i=h,h=g<<30|g>>>2,g=f,f=m,k++;d[0]=d[0]+f|0,d[1]=d[1]+g|0,d[2]=d[2]+h|0,d[3]=d[3]+i|0,d[4]=d[4]+j|0},a.prototype._getInitial=function(){var a;return a=[1732584193,4023233417,2562383102,271733878,3285377520],function(){return a.slice(0)}}(),a}(),g=function(a){return new c(a).finalize()},h.simple("hash:sha1",g),g}),a("sizzle",function(a,b){var c,d,e,f,g,h,i,j,k;e=window,f=a("util"),h=a("dom"),d=/^(?:(\w+)|(\*(?=\W|$))|\.([\w\-]+)|#([\w\-]+))([#\.\w\-]*)/,c=/^\[([\w\-]+)(?:(\W?=)(["']?)([^\]]*)\3(["']?))?\]/,g=b.attr=h.attr,k=b.hasAttr=function(a,b){var c;return a.hasAttribute?a.hasAttribute(b):!(!(c=a.attributes[b])||!c.nodeValue)},i=function(a,b,c,d){var e,h,i,j,l,m,n;for(m=function(a){return function(c){return!!g(c,b).match(a)}},e=d&&f.escapeRegexp(d),n=c?"="===c?function(a){return g(a,b)===d}:"!="===c?function(a){return g(a,b)!==d}:"*="===c?function(a){return g(a,b).indexOf(d)>=0}:"~="===c?m("(^|\\s)"+e+"(\\s|$)"):"|="===c?m("^"+e+"\\b"):"$="===c?m(e+"$"):"^="===c?m("^"+e):"false":function(a){return k(a,b)},l=[],h=0,i=a.length;i>h;h++)j=a[h],n(j)&&l.push(j);return l},j=b.getElementsByClassName=function(a,b){return f.isString(a)&&(b=a,a=e.document),a.getElementsByClassName?a.getElementsByClassName(b):i(a.getElementsByTagName("*"),"class","~=",b)},b.find=function(a,b){var g,h,k,l,m,n,o,p,q,r,s,t;for(null==b&&(b=e.document),t=function(){throw new Error("Error parsing selector query: "+a)},f.isArray(b)||(b=[b]),g=b,s=[],r=void 0,l=0,k=function(a,b){return b[1]?f.toArray(a.getElementsByTagName(b[1])):b[2]?f.toArray(a.getElementsByTagName("*")):b[3]?f.toArray(j(a,b[3])):b[4]&&(b=a.getElementById(b[4]))?[b]:[]},h=function(){s=s.concat(g===b?[]:g),g=b},q=function(a,b){return function(){var c;return(c=r.match(a))?(b(c),c[0].length):0}},o=q(d,function(a){var b,c,d,e,f,h;for(e=[],b=0,c=g.length;c>b;b++)f=g[b],e=e.concat(k(f,a));for(g=e,h=a[5]||"";d=h.match(/^([\.#])([\w\-]+)/);)g="."===d[1]?i(g,"class","~=",d[2]):i(g,"id","=",d[2]),h=h.slice(d[0].length);if(h)throw new Error("parse error")}),m=q(c,function(a){g=i(g,a[1],a[2],a[4])}),p=q(/\s*/,function(){}),n=q(/,/,h);r=a.slice(l);)l+=o()||m()||n()||p()||t();return h(),s}}),a("sniff",function(a){var b,c,d,e,f;return c=window,e=a("util"),d="0",b={CHROME:"Chrome",EDGE:"Edge",FIREFOX:"Firefox",IE:"IE",OPERA:"Opera",OTHER:"Other",PHANTOM:"Phantom",SAFARI:"Safari"},f=function(a,f){var g,h,i,j,k,l,m,n,o,p;return null==a&&(a=null!=(o=c.navigator)?o.userAgent:void 0),null==f&&(f=c.navigator),l=function(c){var d;switch(null==c&&(c=a),d=e.partial(e.matchAll,c),!1){case!d("Edge"):return b.EDGE;case!(d("Chrome","OPR")||d("Presto")):return b.OPERA;case!(d("Chrome")||d("CriOS")):return b.CHROME;case!(d("Trident","Windows")||d("MSIE")):return b.IE;case!d("PhantomJS"):return b.PHANTOM;case!((d("Safari","like Gecko")||d("iPhone")||d("iPad"))&&!d("Linux")&&d("KHTML")):return b.SAFARI;case!d("Gecko","Firefox"):return b.FIREFOX;default:return b.OTHER}},n=function(c,e){var f;switch(null==e&&(e=a),f=function(a){var b;return null!=(b=e.match(a))?b[1]:void 0},!1){case c!==b.EDGE:return f(/Edge\/(\d+)/i);case c!==b.SAFARI:return f(/Version\/(\d+)/i);case c!==b.CHROME:return f(/(?:Chrome|CriOS)\/(\d+)/i);case c!==b.IE:return f(/(?:MSIE\s|rv:)(\d+)/i);case c!==b.FIREFOX:return f(/Firefox\/(\d+)/);case c!==b.OPERA:return f(/(?:OPR|Version)\/(\d+)/);case c!==b.PHANTOM:return f(/(?:PhantomJS)\/(\d+)/);default:return d}},m=function(){var a,b,c,d,e;for(d=["language","systemLanguage","browserLanguage","userLanguage"],a=0,c=d.length;c>a;a++)if(b=d[a],e=null!=f?f[b]:void 0,
null!=e)return e.substring(0,2);return""},g=l(),p=n(g),k=g===b.IE,i=function(a){return k&&p===""+a},j=g===b.FIREFOX,{UNKNOWN_VERSION:d,Browsers:b,browser:g,bucket:function(){switch(!1){case!k:return"IE."+p;case!j:return h=Number(p)<4?"3x":"4plus",g+"."+h;default:return g}}(),is:g,ff:j,ie:k,ie6:i(6),ie7:i(7),ie8:i(8),ie9:i(9),ie10:i(10),ie11:i(11),lang:m(),msie:k,parse:function(b){return null==b&&(b=a),g=l(b),{browser:g,version:n(g,b),language:m()}},ua:a.toLowerCase(),version:p}},e.extend(f,f())}),a("social",function(a,b){var c,d,e,f,g,h,i;c=window,d=a("util"),d.on("social",function(b){var e;e=d.rewriter({facebook:"fb",twitter:"twttr"}),a("http").pixel({url:d.get("url_social"),data:{_kpid:d.get("pubid"),_kcp_s:d.get("site"),_ksoc_t:e(b.provider),_ksoc_e:b.action,_ksoc_url:b.url,_kpa_title:c.document.title}})}),f=function(a,b,c){d.fire("social",{provider:a,action:b,url:c})},e=function(a,b){f("facebook",a,b)},i=function(a){f("twitter","tweet",a)},g=b.init_facebook=function(){var a;a=(a=c.FB)&&(a=a.Event)&&a.subscribe&&d.bind(a.subscribe,a),a?(a("edge.create",d.bind(e,null,"like")),a("edge.remove",d.bind(e,null,"unlike")),a("message.send",d.bind(e,null,"send")),a="done"):a="fail",d.fire("social.init_facebook",{status:a})},h=b.init_twitter=function(){var a;a=(a=c.twttr)&&(a=a.events)&&a.bind&&d.bind(a.bind,a),a?(a("tweet",function(a){i(a&&a.target&&"IFRAME"===a.target.nodeName?a.target.src:null)}),a="done"):a="fail",d.fire("social.init_twitter",{status:a})},a("routes").simple("social.init",function(){c.setTimeout(function(){g(),h()},1e3)})});var d=function(a,b){return function(){return a.apply(b,arguments)}};a("stateful",function(a,b){var c,e,f,g,h;return e=window,h=a("util"),c="all",g=/(?:([a-z]*):)?([^:]+)$/i,f=function(){function a(a,b){this._raw=null!=a?a:{},this._defaults=null!=b?b:{},this._mkRemover=d(this._mkRemover,this),this._addHandler=d(this._addHandler,this),this._fire=d(this._fire,this),this.toString=d(this.toString,this),this.watch=d(this.watch,this),this.remove=d(this.remove,this),this.has=d(this.has,this),this.set=d(this.set,this),this.get=d(this.get,this),this._handlers={all:[]}}return a.prototype.get=function(a){var b;return b=this._raw[a],null!=b?b:this._defaults[a]},a.prototype.set=function(a,b){var c;return c=this._raw[a],this._raw[a]=b,this._fire("set",a,c,b),this},a.prototype.has=function(a,b){return null!=this._raw[a]||b&&null!=this._defaults[a]},a.prototype.remove=function(a,b){var c,d;return c=function(b){return function(c,d){null!=d&&b._fire(c,a,d,void 0)}}(this),d=this._raw[a],delete this._raw[a],c("remove",d),b&&(d=this._defaults[a],delete this._defaults[a],c("removeDefault",d)),this},a.prototype.watch=function(a,b,d){var e,f,i,j;if(!h.isFunction(b))throw new Error("Watch expected function, but got: "+b+" \nContext: "+this);return j=void 0,e=void 0,f=a.match(g),a===c?(e="",j=a):f[1]&&f[1]!==c?(j=f[1],e=f[2]):(e=f[2],j=c,a=j+":"+e),i=this._mkRemover(a,b),this._addHandler(a,{context:d,fn:b,key:e,remove:i,type:j}),i},a.prototype.toString=function(){return"Stateful"+e.JSON.stringify(this._raw)},a.prototype._fire=function(a,b,d,e,f){var g,h,i,j,k,l,m,n;for(i=this._handlers,k=function(a){return a.fn.call(a.context||null,b,d,e)},g=function(b){return i[c].concat(i[c+":"+b]||[]).concat(i[a+":"+b]||[])},m=g(b),j=0,l=m.length;l>j;j++)h=m[j],n=k(h),null!=n&&((f||this._raw)[b]=n);return this},a.prototype._addHandler=function(a,b){var c;return c=this._handlers[a],c||(c=this._handlers[a]=[]),c.push(b),this},a.prototype._mkRemover=function(a,b){return function(c){return function(){var d;c._handlers[a]=function(){var c,e,f,g;for(f=this._handlers[a],g=[],c=0,e=f.length;e>c;c++)d=f[c],d.fn!==b&&g.push(d);return g}.call(c)}}(this)},a}(),h.extend(function(a,b){return new f(a,b)},{Stateful:f},b)}),a("stats",function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n;c=a("util"),l=a("sniff"),a("events"),a("data"),f={counter:{},time:{}},g=b.get=function(a,b){return f[a][b]},k=b.set=function(a,b,c){f[a][b]=c},b.time=function(a,b){k("time",a,b)},h=b.inc=function(a){var b;b=g("counter",a)||0,k("counter",a,b+1)},i=b.incPath=function(a){var b;b=a.split("."),c.times(b.length,function(a){h(c.first(b,a+1).join("."))})},m=0,d="."+l.bucket,e="."+c.get("config_param_control_tag_version"),n=e+d,i("views"+n),c.on("social",function(a){h(a.provider+"."+a.action)}),c.on("tag:done",function(){i("tags_delivered"+n)}),j=0,c.on("error",function(){var a,b;try{if(j>10)return;j++,i("js_errors"+n)}catch(a){return void(b=a)}}),m=".alpha"===e?1:".beta"===e||".stable"===e?.01:.001,Math.random()<m&&c.onOnce("tag:all_done",function(){var b,d,e,g;b=function(a,b,c){return"controltagv2."+b+":"+c+"|"+a},e=function(){var a,c;a=f.counter,c=[];for(d in a)g=a[d],c.push(b("c",d,g));return c}().concat(function(){var a,c;a=f.time,c=[];for(d in a)g=a[d],c.push(b("ms",d,g));return c}()).join(","),a("http").pixel({url:c.get("url_stats"),data:{q:e,format:"gif"}})})});var c=[].slice;a("store",function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;for(e=window,j=a("util"),r=a("feature"),u=a("json"),G=a("whitelist"),a("events"),x=function(){var a;try{return e.localStorage}catch(a){return p=a,null}}(),o=e.document,H=["set","get","remove","count","namespace"],q=H.concat(["clear","count","forEach"]),B="",F=b.whitelist=G(G.ALL),C=["allowAll","allowNone","allowOnly"],s=0,v=C.length;v>s;s++)y=C[s],b[y]=j.bind(F[y],F);i=j.SECONDS,g=j.MINUTES,f=j.HOURS,d=j.DAYS,j.extend(b,{SECONDS:i,MINUTES:g,HOURS:f,DAYS:d}),h=b.READY_EVENT="store:ready",E=function(a){return new Date(j.now()+1e3*a)},k=function(a){return b.prefix&&0!==a.indexOf(B)&&(a=B+a),a},D=function(a){return b.prefix?a.replace(new RegExp("^"+B),""):a},n={domain:function(a){return"; domain="+a}},t=function(a){return F.has(D(a))||F.has(a)},m=b.cookie={_COOKIE_START:"(?:^|\\s|;)",set:function(a,b,c,d){return t(a)?m._set.apply(m,arguments):""},get:function(a,b){var c,d;return null==b&&(b=""),d=""+m._COOKIE_START+a+"=([^;]*)",y=null!=(c=o.cookie)?c.match(d):void 0,null!=y?e.decodeURIComponent(y[1]):b},count:function(a,b,c){return null==b&&(b=1),null==c&&(c=j.endOfDay()),m.set(a,Number(m.get(a,0))+b,c)},remove:function(a,b){null==b&&(b={}),m._set(a,0,-1,b)},namespace:function(a){var b,c;return b={},c=new RegExp(""+m._COOKIE_START+a+"([^=]*)=([^;]*)","g"),o.cookie.replace(c,function(a,c){b[decodeURIComponent(a)]=decodeURIComponent(c)}),b},forEach:function(a){return null==a&&(a=function(a,b){}),w.until(function(b,c){return a(b,c),!1})},until:function(a){var c,d,e,f,g,h,i;for(null==a&&(a=j.yes),g=o.cookie.split(/\s*;\s*/),c=0,e=g.length;e>c;c++)if(f=g[c],0===f.indexOf(b.prefix)&&(h=f.split("="),d=h[0],i=h[1],a(i,d.slice(b.prefix.length))))return},clear:function(a){var b,c,d,e,f,g,h;for(null==a&&(a=j.yes),f=o.cookie.split(/\s*;\s*/),b=0,d=f.length;d>b;b++)e=f[b],g=e.split("="),c=g[0],h=g[1],t(c)&&a(h,D(c))||m.remove(k(c))},size:function(){return j.measureString(o.cookie.replace(/(?:;\s*|=)/g,""))},_set:function(a,b,c,d){var e,f;return e=c?"; expires="+E(c).toUTCString():"",f=a+"="+encodeURIComponent(b)+m._optionsToCookie(d)+";path=/"+e,o.cookie=f,f},_optionsToCookie:function(a){var b,c,d;c="";for(b in a)d=a[b],b in n&&(c+=n[b](d));return c}},z=function(a){var b,d,e,f,g;for(b=j.clone(a),f=function(b){return function(){var d;d=1<=arguments.length?c.call(arguments,0):[];try{return a[b].apply(a,d)}catch(e){}}},d=0,e=H.length;e>d;d++)g=H[d],b[g]=f(g);return b},w=b.local=x&&z({set:function(a,b,c){return t(a)?(x.setItem(a,b),c?x.setItem("_"+a,+E(c)):x.removeItem("_"+a),b):""},get:function(a,b){var c,d;return null==b&&(b=""),d=x.getItem(a),c=x.getItem("_"+a),c&&c<=new Date&&(d=null,w.remove(a)),d||b},remove:function(a){x.removeItem(a),x.removeItem("_"+a)},count:function(a,b,c){return null==b&&(b=1),null==c&&(c=j.endOfDay()),w.set(a,Number(w.get(a,0))+b,c)},namespace:function(a){var c,d;d={};for(c in x)y=c.match("^"+a+"(.*)"),y&&(d[y[1]]=b.get(y[1]));return d},forEach:function(a){return null==a&&(a=function(a,b){}),w.until(function(b,c){return a(b,c),!1})},until:function(a){var c;null==a&&(a=j.yes);for(c in x)if(0===c.indexOf(b.prefix)&&a(w.get(c),c.slice(b.prefix.length)))return},clear:function(a){var b;null==a&&(a=j.yes);for(b in x)t(b)&&a(w.get(b),D(b))||w.remove(k(b))},size:function(){return j.measureString(u.stringify(localStorage))}}),A=a("ns"),B=b.prefix="kx"+(A.isDefault?"":A.name+"_"),l=function(a){var b,d,e,f;for(b=j.clone(a),f=function(b){return function(){var d,e;return e=arguments[0],d=2<=arguments.length?c.call(arguments,1):[],null==e&&(e=""),a[b].apply(a,[k(e)].concat(c.call(d)))}},d=0,e=H.length;e>d;d++)y=H[d],b[y]=f(y);return b},b.init=function(){var a,c,d,e;for(e=r.hasLocalStorage()?w:m,a=b.impl=l(e),c=0,d=q.length;d>c;c++)y=q[c],b[y]=a[y];return j.fire(h),a}}),a("tag-actions",function(a,b){var c,d,e,f,g,h;d=a("util"),e=a("tag-delivery"),f=a("tag-delivery-timing"),g=a("events").instance,c="tag:all_done",h=function(a,b){return function(a){var h,i,j;g.clear("tag"),i=function(){var a,c,f,g;for(f=d.get("tags"),g=[],a=0,c=f.length;c>a;a++)j=f[a],b(j)&&(e.forget(j),g.push(j));return g}(),f(i),d.on(c,h=function(){a(null),d.off(c,h)})}},b.DEFAULT="all",b[b.DEFAULT]=h("*",d.yes)}),a("tag-delivery-timing",function(a,b){var c,d,e,f,g,h,i,j,k,l;return c=a("util"),d=a("config"),j=f=a("tag-delivery"),e=j.deliver,h=j.isIdDelivered,i=j.meetsCriteria,l=j.uniqueName,g=a("dom"),k=b.isDone=function(a){var b;return null!=(null!=(b=a.time)?b.end:void 0)||null!=a.error||a.metCriteria===!1},c.extend(function(a){var b,j,m,n,o,p;for(m=0,o=a.length;o>m;m++)p=a[m],l(p);return b=function(){c.all(a,k)&&(b=c.noop,c.fireOnce("tag:all_done"))},c.on("tag:done",function(){b()}),c.on("tag:fail",function(){b()}),b(),n=function(a,b){var d;if(d=a===b,!(c.get("schema_version",2)>=3))return d;switch(a){case"onready":return"onload"!==b;case"onload":return!0;default:return d}},j=function(c){var d,f,g;for(d=0,f=a.length;f>d;d++)g=a[d],!h(g.id)&&n(c,g.timing)&&i(g)&&e(g);b()},g.ready(c.once(function(){return g.createHead(d().get("confid")),j("asap"),j("onready")})),g.load(c.once(j,null,"onload")),f.init(),{deliver:j,isDone:function(){return b!==c.noop}}},b,f)}),a("tag-delivery",function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;c=window,d=a("util"),f=a("config"),g=c.document,h=a("data"),i=a("dom"),j=a("geo"),m=a("hash-set"),q=a("ns"),v=a("store"),B=a("x-frame"),t=a("routes"),a("data"),l=function(a){var b;return a&&a.nodeType?a:a&&(b=a.match(/^(head|body)$/))?g[b[1]]:g.getElementById(a)},w=null,o=b.mode=function(){switch(!1){case"1"!==d.param("writeCapture"):return"writeCapture";case"1"!==d.param("writeNativeIframe"):return"nativeIframe";case"1"!==d.param("writeOld"):return"old";default:return"newWriter"}}(),b.forget=function(a){return a.metCriteria=void 0,a.time={},a.delivered=!1,a},x={},d.set("tagsByName",x),z=b.uniqueName=function(a){var b,c;if(!a.named){for(c=a.name,b=1;null!=x[c];)b++,c=a.name+"_"+b;a.name=c,a.named=!0,x[c]=a}},A=function(a,b,d,e){var f,g,h,i,j,k;if(a.root=b,null==a.content&&(a.content=""),h=0===a.template_replacement?a.content:u(a.content),k=c.Krux,g=function(){w=y(),w.tag={id:a.id,name:a.name,method:a.method,target:a.target,target_action:a.target_action},q.isDefault||(c.Krux=q.self)},f=function(){w=null,q.isDefault||(c.Krux=k)},"writeCapture"===o)return g(),c.$(b).attr("data-writeCapture","true"),c.$(b).writeCapture().html(h,{done:d}),f();if("nativeIframe"===a.method||"native"===o&&a.target)return g(),b.ownerDocument.write(h),f(),d();try{return c.Krux.postscribe(b,h,{afterDequeue:g,afterStreamStart:f,done:d,error:e,name:a.name,releaseAsync:!0})}catch(j){return i=j,e(i)}},k=b.getTagContext=function(a){return null!=w?w[a]:void 0},t.simple("context",k),t.simple("nativeTag",function(a){"native"===o&&b.deliver(d.get("tagsByName")[a])}),t.simple("writeHtml",function(a,c,d){return b.deliver({name:d||"Anonymous",content:c,target:a[0]||a})}),s=function(a,b){var c,d;return d=a.target?l(a.target):i.kxhead||g.getElementsByTagName("script")[0].parentNode,d&&(c=a.target_action||"append",i[c](d,b)),d},e=function(a){var b;return b={"class":"kxtag","data-id":a.id,"data-alias":a.name},b["class"]+=a.target?" kxtargeted":" kxinvisible",b},n={eval:function(a,b,c){var e,f,g;g=void 0;try{g=d.globalEval(a.content)}catch(f){e=f,c(e)}return b(),g},apply:function(a,b,c){var d,e,f;f=void 0;try{f=a.content.apply(null)}catch(e){d=e,c(d)}return b(),f},document:function(a,b,c){var d,f;return d=i.createElement("span",e(a)),f=s(a,d),f?A(a,d,b,c):b(),d},iframeCommon:function(a,b,d,f){var g,h,j,k,l;return g=e(a),g.width=g.height=0,g.scrolling="no",g.style="overflow:hidden;",k=a.name.match(/(\d+)x(\d+)/),k&&(g.width=k[1]+"px",g.height=k[2]+"px"),h=i.createElement("iframe",g),l=s(a,h),l?(j=h.contentWindow.document,j.open(),j.write("<html><head></head><body style='margin:0;'>"),f.leaveOpen||j.close(),f.onIframe&&f.onIframe(h),h.contentWindow.Krux=c.Krux,A(a,h.contentWindow.document.body,b,d)):b(),h},nativeIframe:function(a,b,c,d){return d.leaveOpen=!0,n.iframeCommon(a,b,c,d)},iframe:function(a,b,c,d){return n.iframeCommon(a,b,c,d)}},y=b.templateData=function(){var a;return{id:null!=(a=d.get("currentTag"))?a.id:void 0,pubid:d.get("pubid"),site:d.get("site"),geo:j.get(),now:new Date}},u=b.runTemplate=function(b){return a("underscore").templateSettings={evaluate:/\{%([\s\S]+?)%\}/g,interpolate:/\{\{([\s\S]+?)\}\}/g,escape:/\{%-([\s\S]+?)%\}/g},d.template(b,y())},b.meetsCriteria=function(b){var c,e,f,g;if(b.once_per_page&&r.has(b))return b.metCriteria=!1;if(null==b.criteria)return b.metCriteria=!0;if("native"===o&&null!=b.target)return b.metCriteria=!1;d.set("now",new Date),b.freq_cap&&d.set("tag_deliveries_today",+v.get("tag"+b.id+".day",0)),g={currentTag:b,frequency:+v.get("visits"),geolocation:j().get("country"),throttle:b.random,url:document.location.href};for(c in g)f=g[c],h.setSilently(c,f);e=b.metCriteria=a("expression").eval(b.criteria);for(c in g)h.remove(c);return e},p=0,r=q.self._oneTimeTags=q.self._oneTimeTags||m(function(a){return a.id}),b.isIdDelivered=function(a){var b;return(null!=(b=d.find(d.get("tags",[]),function(b){return b.id===a}))?b.delivered:void 0)===!0},b.deliver=function(a,b){var c,e,f,g,h,i,j;if(null==b&&(b={}),i=a.once_per_page,i&&r.has(a))return r.get(a).id;z(a),a.id=a.id||p++,a.time={mode:"async",start:d.ms()},null==a.method&&(a.method=d.isFunction(a.content)?"apply":"document"),"nativeIframe"===o&&a.target&&(a.method="nativeIframe"),a.delivered=!0,f=function(){a.time.end=d.ms(),a.time.duration=a.time.end-a.time.start},h=function(b){a.error=b&&b.message&&b||{message:"unknown error"},d.fire("tag:fail",{id:a.id,alias:a.name,error:a.error.message})},d.fire("tag:started",{id:a.id,alias:a.name}),c=function(){f(),a.freq_cap&&v.count("tag"+a.id+".day"),d.fire("tag:done",{id:a.id,alias:a.name})};try{j=n[a.method](a,c,h,b),i&&r.put({id:a.id})}catch(g){e=g,h(e)}return j},b.claimOneTimers=function(a){var b,c,e,f;null!=a&&(e=function(){var b,c,d;for(d=[],b=0,c=a.length;c>b;b++)f=a[b],f.once_per_page&&d.push(f);return d}()),b=d.now(),c=function(){var a,c,d,g;for(d=e||[],g=[],a=0,c=d.length;c>a;a++)f=d[a],g.push({id:f.id,claimId:b});return g}(),c.length&&(B.broadcast({tags:c}),B.listen(function(a){var b,d,e,g,h,i,j,k;for(k=[],j=a.data.tags,e=0,h=j.length;h>e;e++){for(f=j[e],d=void 0,g=0,i=c.length;i>g;g++)if(b=c[g],b.id===f.id){d=b;break}f.claimId<(null!=d?d.claimId:void 0)&&k.push(f)}r.put.apply(r,k)}))},b.init=d.once(function(){v.count("visits"),a("test").module("tag-delivery",function(a){var b,c,e,f,g,h,i,j,k,l;for(l={},k=function(b){var c;return c=b.timing,a("tag_valid_timing_name",c,c),l[c]=l[c]||{lastStart:0}},f=d.get("tags"),c=0,e=f.length;e>c;c++)h=f[c],d.happened("dom:beforeunload")||d.happened("dom:unload")||a("tag_considered",null!=h.metCriteria,h.name),h.metCriteria&&(i=h.time||{},g=i.start,b=i.end,a("tag_delivered",b,h.name),j=k(h),a("tag_order",g>=j.lastStart,h.name),j.lastStart=g)})})}),a("tag",function(a,b){var c,d,e,f,g,h,i,j,k,l;c=a("util"),d=a("tag-actions"),e=a("config"),f=a("dag"),g=a("tag-delivery-timing"),h=a("privacy"),i=a("routes"),l=a("store"),a("data"),c.extend(b,g,{Timing:g}),j=function(a,b,d){var e,f,g,h,i;for(h=[],e=f=0,g=a.length;g>f;e=++f)i=a[e],b(i,e,a)&&d(i,e,a),c.isArray(i)?h.push(j(i,b,d)):h.push(void 0);return h},k=b.sorted=function(a){var b,d,e,g,h,i,k,l,m,n,o,p,q,r;for(a=a.sort(function(a,b){var c,d;switch(c=a.lid,d=b.rid,!1){case!(d>c):return-1;case!(c>d):return 1;default:return 0}}),d=f(),p=function(a){var b;return b=a[0],"afterTag"===b||"beforeTag"===b},n=function(a){return function(b){var c,e;switch(c=b[0],e=b[1],c){case"afterTag":return d.add([e,a]);case"beforeTag":return d.add([a,e])}}},i=0,l=a.length;l>i;i++)q=a[i],g=q.id,b=q.criteria,j(b,p,n(g));for(h=c.uniq(d.toArray().concat(function(){var b,c,d;for(d=[],b=0,c=a.length;c>b;b++)g=a[b].id,d.push(g);return d}())),e=function(a){return function(b){return b.id===a}},o=[],k=0,m=h.length;m>k;k++)g=h[k],r=c.find(a,e(g)),null!=r&&o.push(r);return o},b.init=function(){var a;h.storeKuid(),c.onOnce("user_data_response",function(){h.storeKuid()}),a=k(c.get("tags")),c.set("tags",a),g(a)},i.regexp(/^tag:reload:?(.*)$/,function(a,b){var c,e,f;if(c=a[1]||d.DEFAULT,c in d)try{d[c](b)}catch(f){e=f,b(e)}else b(new TypeError("Krux('tags') has no method: "+c))})}),a("test-visualtags",function(a,b){var c,d,e,f,g,h,i,j,k;k=function(a){var b,d,j,k,l,m,n,o,p,q,r;for(l=c(".kxtargeted"),b=0,d=l.length;d>b;)q=l[b].getAttribute("data-id"),o=l[b].getAttribute("data-alias"),j=i(q),k=c("#"+j),r=1===k.length?k[0]:l[b].parentNode,p=Math.max(h("width",l[b]),g("width",r)),n=Math.max(h("height",l[b]),g("height",r)),m=p*n,a("visualtag-not-blank",m,"Tag area appears to be empty ("+o+")"),r.style&&e(r.style.width)&&a("visualtag-expected-width",f(e(r.style.width),p)<10,"Tag width ain't right ("+o+")"),r.style&&e(r.style.height)&&a("visualtag-expected-height",f(e(r.style.height),n)<10,"Tag height ain't right ("+o+")"),b++},e=function(a){return(""+a).indexOf("px")>-1?parseInt(a.replace("px",""),10)||0:0},f=function(a,b){return Math.floor(Math.abs(a-b)/b*100)},i=function(a){var b,c;c=d.get("tagsByName");for(b in c)if(c[b].id===a)return c[b].target||"";return""},h=function(a,b){var c;return c="offset"+("width"===a?"Width":"Height"),b[c]||0},g=function(a,b){var c,d,e;if(j++,j>1e3)return 0;for(e=0,d="offset"+("width"===a?"Width":"Height"),c=0;c<b.childNodes.length;)e=Math.max(e,b.childNodes[c][d]||0),b.childNodes[c].childNodes.length&&(e=Math.max(e,g(a,b.childNodes[c]))),c++;return e},d=a("util"),c=a("sizzle").find,b.init=function(){a("test").module("visualtags",function(a){k(a)})},j=0});var c=[].slice;a("test",function(a,b){var d,e,f,g,h,i,j,k,l;d=window,e=a("util"),i={},h="test",b.status="NOT_STARTED",l=b.test=function(a,c,d){var f;return f=c?"pass":"fail",b.results.push({module:h,code:a,data:d,assertion:c,time:new Date,status:f}),e.fire("test:"+f,{code:a,data:d}),c},g=function(a,b){return e.isArray(a)&&e.isArray(b)?a.length===b.length&&e.all(a,function(a,c){return g(a,b[c])}):a===b},l.eq=function(a,b,c){return l(a,g(b,c),{actual:b,expected:c})},f=function(){"NOT_STARTED"!==b.status&&l("tests_not_started",!1,b.status)},b.module=function(a,b){f(),i[a]=b},k=function(a,b){var c,d;h=a;try{b(l)}catch(d){c=d,l("tests_module_threw",!1,"module_"+a+"_threw:"+c.message)}},j=b.run=function(){var a,f,g,h,j,m,n,o,p,q,r,s,t,u;b.results=[],b.failureGroup=null,l("tests_to_run",!e.isEmpty(i));for(p in i)o=i[p],k(p,o);if(s=b.report=e.groupBy(b.results,"status"),s.total=b.results.length,s.toString=function(){var a,e,f,g,h,i,j,k;try{for(a=[],k=function(){var b;b=1<=arguments.length?c.call(arguments,0):[],a.push(b.join(""))},k("Test Summary: "+b.status),k("Version: "+d.Krux.version+", "+d.Krux.commit),b.failureGroup&&k("Failure Group:"+b.failureGroup),k("Phase: "+b.phase),k("Status,Code,Data"),j=b.results,g=0,h=j.length;h>g;g++)i=j[g],k(i.status,",",i.code,",",i.data);return a.join("\n")}catch(f){return e=f,"report.toString failed: "+e}},u=b.status=s.status=s.fail?"FAIL":"PASS","PASS"!==u){for(n=-1,q=void 0,f=1e3,a=[],m={tests_to_run:f--,tests_module_threw:f--,pixel:f--,tag_delivered:f--},r=s.fail,g=0,h=r.length;h>g;g++)t=r[g],j=m[t.code]||0,a.push(t.code+": "+t.data),j>n&&(n=j,q=t);b.failureGroup=q.code+(q.data?":"+q.data:""),b.phase=e.happened("dom:load")?"after_load":e.happened("dom:ready")?"after_ready_before_load":"before_ready"}e.fire("test:all_done",{status:u})},b.init=function(){var a;a=e.once(j),e.on("pixel",a),e.on("dom:beforeunload",a),e.on("dom:unload",a)}}),a("timing",function(a){var b,c,d;return b=a("data"),d=a("util").now,c=function(a){return function(){return b.set(a,d())}},{start:c("started"),end:c("ended")}});var c=[].slice;a("util",function(a,b){var d,e,f,g,h,i,j,k,l;e=window,j=a("underscore"),j.extend(b,j,{_:j}),j=b,j.globalEval=function(a,b){b=b||e,a&&/\S/.test(a)&&!function(a){b.eval.call(b,a)}(a)},j.parseParams=j.parseKeyValues=function(a,b,c,d){var e,f;return null==b&&(b="&"),null==c&&(c="="),null==d&&(d=decodeURIComponent),e={},"string"!=typeof a?e:(f=new RegExp(b+"*([^"+c+b+"]+)"+c+"([^"+b+"]+)"+b+"*","g"),a.replace(f,function(a,b,c){c=function(){try{return d(c)}catch(a){return c}}(),e[b]=e[b]?j.isArray(e[b])?e[b].concat([c]):[e[b],c]:c}),e)},j.shuffle=function(a){var b,c,d;for(b=a.length;b>0;)c=Math.floor(Math.random()*b),b--,d=[a[c],a[b]],a[b]=d[0],a[c]=d[1];return a},j.urlParams=function(a){return null==a&&(a=e.location.href),j.parseParams(j.compact(a.match(/[^\#?]+(?:\?([^#]*))?(?:#(.*))?/).slice(1)).join("&"))},j.paramString=function(a,b,c,d){var e,f,g,h,i,k,l;null==b&&(b="&"),null==c&&(c="="),null==d&&(d=encodeURIComponent),h=[];for(f in a)for(l=a[f],i=j.isArray(l)?l:[l],e=0,g=i.length;g>e;e++)k=i[e],null!=k&&""!==k&&h.push(""+d(f)+c+d(k));return h.join(b)},j.isPrimitive=function(a){return null==a||!/^object|function$/.test(typeof a)&&!j.isNaN(a)},j.isSerializable=function(a){return j.isPrimitive(a)||!/[object [^\]]*]/.test(String(a))},j.remove=function(a,b){var c,d,e,f;if(a){for(e=[],c=0,d=a.length;d>c;c++)f=a[c],f!==b&&e.push(f);return e}},j.escapeRegexp=function(){var a,b;return b=["/",".","*","+","?","|","(",")","[","]","{","}","\\"],a=new RegExp("(\\"+b.join("|\\")+")","g"),function(b){return(""+b).replace(a,"\\$1")}}(),j.noop=function(){},j.defer=function(a){var b;b=j.rest(arguments),e.setTimeout(function(){a.apply(null,b)},0)},l=[],l.toString=function(){return e.JSON.stringify(l)},j.log=function(a){return j.isString(a)&&e.console?void 0:a?(a.time=new Date,void l.push(a)):l},j.Set=function(a){var b;for(b=0;b<a.length;)this[a[b]]=!0,b++},j.negate=function(a){return function(){return!a.apply(this,arguments)}},j.G=e,j.bind=function(a,b){var c,d;return a.isBound&&arguments.length<3?a:(d=j.rest(arguments,2),c=function(){return a.apply(b,d.concat(j.toArray(arguments)))},c.actual=a,c.isBound=!0,c)},j.interpolate=function(a,b){return b.replace(/\$\{([^{}]*)\}/g,function(b,c){var d;return d=a[c],"string"==typeof d||"number"==typeof d?d:b})},j.rewriter=function(a){return function(b){return a[b]||b}},j.extend(j,{max:Math.max,min:Math.min}),j.once=function(a){var b,c,d;return a.isOnce&&arguments.length<3?a:(b=!1,d=void 0,a=j.bind.apply(null,arguments),c=function(){return b?d:(b=!0,d=a.apply(null,arguments))},c.isOnce=!0,c.actual=a,c)},j.ms=function(){return new Date-j.get("started")},j.param=function(a){var b;return(b=e.location.href.match("\\bkx"+a+"(?:=|\\b)([^&\\#]*)"))&&(b[1]||!0)},j.keys=function(a){var b,c;c=[];for(b in a)c.push(b);return c},j.values=function(a){var b,c,d;switch(!1){case!(null==a):return[];case!j.isArray(a):return a.slice(0);default:c=[];for(b in a)d=a[b],c.push(d);return c}},j.attributes=function(a){var b;return b=function(a,c){var d;return d=arguments.length,0===d?b.all():j.isString(a)?1===d?b.get(a):b.set(a,c):b.set(a)},b.get=a.get,b.all=a.all,b.set=function(b,c){var d,e,f;if(null!=c)return a.set(b,c);if(j.isObject(b)){e=[];for(d in b)f=b[d],e.push(a.set(d,f));return e}},a.values&&b.set(a.values),b},j.range=function(a,b,c){var d,e,f;for(arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1,e=Math.max(Math.ceil((b-a)/c),0),d=0,f=new Array(e);e>d;)f[d++]=a,a+=c;return f},j.deref=j.dereference=function(a,b){var c,d,f,g;1===arguments.length&&(b=a,a=e);try{for(g=b.split("."),c=0,f=g.length;f>c;c++)d=g[c],a=a[d];return a}catch(h){}},j.yes=function(){return!0},j.matchAll=function(){var a,b,d,e,f;for(f=arguments[0],e=2<=arguments.length?c.call(arguments,1):[],a=0,b=e.length;b>a;a++)if(d=e[a],!(null!=d.test?d.test(f):-1!==f.indexOf(d)))return!1;return!0},j.numberToRangeBucket=function(a,b,c,d){var e,f;return null==c&&(c=0),null==d&&(d=1/0),c>a?"<"+c:a>d?d+"+":(e=b*Math.ceil(a/b),f=e-b,f+"-"+e)},j.measureString=function(a){var b,c,d,e,f;for(null==a&&(a=""),b=0,d=e=0,f=a.length;f>=0?f>e:e>f;d=f>=0?++e:--e)c=a.charCodeAt(d),b+=function(){switch(!1){case!(256>c):return 1;case!(65536>c):return 2;case!(16777216>c):return 3;default:return 4}}();return 2*b},j.rate=function(a){return Math.random()<=a},g=60,f=60*g,d=24*f,h=30*d,i=365*h,k=function(){var a;return a=new Date(j.now()+864e5),(new Date(a.getFullYear(),a.getMonth(),a.getDate())-new Date)/1e3},j.extend(b,{SECONDS:1,MINUTES:g,HOURS:f,DAYS:d,MONTHS:h,YEARS:i,endOfDay:k})}),a("uuid",function(a){var b;return b=a("util").now,function(){return(""+b()+Math.random()).replace(/[^\d]*/g,"")}}),a("version",function(){return{commit:"8443f4a",version:"5.65.7"}}),a("whistle",function(a){var b,c,d,e,f,g,h;return e=a("util"),f=a("dom"),g=a("store"),d=a("privacy").USER_ID_TTL,a("events"),b="pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links",c="width: 1px !important; height: 1px !important; position: absolute !important; left: -10000px !important; top: -1000px !important;",h=function(a){var b;return!f.attr(document.body,"abp")&&null!=a.offsetParent&&a.offsetHeight&&a.offsetLeft&&a.offsetTop&&a.offsetWidth&&a.clientHeight&&a.clientWidth?(b="function"==typeof getComputedStyle?getComputedStyle(a,null):void 0,"none"===b.display||"hidden"===b.visibility):!0},e.extend(function(a,i){return null==a&&(a=function(){}),null==i&&(i=250),f.ready(function(){var j;return j=f.create("img",{"class":b,style:c}),f.append(document.body,j),setTimeout(function(){var b;return b=h(j),e.fire("whistle",{value:b}),a(b),g.set("whistle",Number(b),d),f.remove(j)},i)})},{taken:h,BAIT_CLASSES:b,BAIT_STYLES:c,status:function(){return Number(g.get("whistle"))}})});var d=function(a,b){return function(){return a.apply(b,arguments)}},e=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},f={}.hasOwnProperty,c=[].slice;a("whitelist",function(a){var b,f,g;return g=a("util"),b=a("hash-set").HashSet,f=function(a){function b(){var a;a=1<=arguments.length?c.call(arguments,0):[],this._none=d(this._none,this),this._all=d(this._all,this),this._hasMatch=d(this._hasMatch,this),this.toString=d(this.toString,this),this.allowNone=d(this.allowNone,this),this.allowAll=d(this.allowAll,this),this.allowOnly=d(this.allowOnly,this),this.put=d(this.put,this),this.has=d(this.has,this),this.get=d(this.get,this),b.__super__.constructor.apply(this,[String].concat(c.call(a)))}return e(b,a),b.ALL={toString:function(){return"ALL"}},b.NONE={toString:function(){return"NONE"}},b.prototype.get=function(a){switch(!1){case!this._all():return a;case!this._none():return null;default:return b.__super__.get.call(this,a)}},b.prototype.has=function(a){switch(!1){case!this._none():return!1;case!this._all():return!0;default:return b.__super__.has.call(this,a)||this._hasMatch(a)}},b.prototype.put=function(){var a;return a=1<=arguments.length?c.call(arguments,0):[],(this._all()||this._none())&&(this._items={}),b.__super__.put.apply(this,a)},b.prototype.allowOnly=function(){var a;return a=1<=arguments.length?c.call(arguments,0):[],this.empty(),this.put.apply(this,a)},b.prototype.allowAll=function(){return this.empty(),this._items=b.ALL,this},b.prototype.allowNone=function(){return this.empty(),this._items=b.NONE,this},b.prototype.toString=function(){return g.isSerializable(this._items)?String(this._items):b.__super__.toString.call(this)},b.prototype._hasMatch=function(a){var b,c,d;this._thunk(),d=this._items;for(b in d)if(c=d[b],null!=c.test&&g.isFunction(c.test)&&c.test(a))return!0;return!1},b.prototype._all=function(){return this._items===b.ALL},b.prototype._none=function(){return this._items===b.NONE},b}(b),g.extend(function(a){var b;return b=new f,a&&a!==f.ALL?a===f.NONE?b.allowNone():b.put.apply(b,arguments):b.allowAll(),b},{Whitelist:f,ALL:f.ALL,NONE:f.NONE})}),a("x-frame",function(a,b){var c,d,e,f,g,h,i;c=window,d=a("util"),f=a("dom"),h=f.d2on,e="*",g=b.isFramed=function(){return c.top!==c},i=b.send=function(a,b,e){if(d.isFunction(a.postMessage))try{a.postMessage(c.JSON.stringify(b),e)}catch(f){}},b.broadcast=function(a,b){var f,h,j,k,l;for(null==b&&(b={}),b=d.defaults(b,{container:!0,domain:e,self:!1}),f=g()?c.parent:c,b.container&&(g()||b.self)&&i(f,a,b.domain),h=f.frames,j=k=0,l=h.length-1;l>=0?l>=k:k>=l;j=l>=0?++k:--k)(h[j]!==c||b.self)&&i(h[j],a,b.domain)},b.listen=function(a,b){var f;return f=d.defaults(b||{},{origin:e,strict:!0,win:c.window}),h(f.win,"message",function(b){f.strict&&0!==String(b.origin||"").indexOf(f.origin)||a.call(this,{data:d.isString(b.data)?c.JSON.parse(b.data):b.data,event:b})})},b.init=function(a){e=a}}),b("index")}();